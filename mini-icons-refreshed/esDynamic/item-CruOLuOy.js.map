{"version":3,"file":"item-CruOLuOy.js","sources":["../../src/fixtures/legend/components/checkbox.vue","../../src/fixtures/legend/components/legend-options.vue","../../src/fixtures/legend/components/symbology-stack.vue","../../src/fixtures/legend/components/layertype-icon.vue","../../src/fixtures/legend/components/item.vue"],"sourcesContent":["<template>\n    <div class=\"relative\" @mouseover.stop>\n        <!-- TODO: see if getting this to use v-model works; children wouldnt update properly on initial try -->\n        <input\n            :type=\"isRadio ? 'radio' : 'checkbox'\"\n            :aria-label=\"t(checked ? `legend.visibility.hide${label}` : `legend.visibility.show${label}`)\"\n            @click.stop=\"toggleVisibility()\"\n            :checked=\"checked && initialChecked\"\n            @keypress.enter.prevent\n            @keyup.enter.stop=\"toggleVisibility()\"\n            :class=\"[\n                disabled\n                    ? 'text-gray-400 border-gray-300'\n                    : 'text-black cursor-pointer border-gray-500 hover:border-black'\n            ]\"\n            class=\"mx-5 h-15 w-15\"\n            tabindex=\"-1\"\n            :disabled=\"disabled\"\n            :content=\"t(checked ? `legend.visibility.hide${label}` : `legend.visibility.show${label}`)\"\n            v-tippy=\"{ placement: 'top-end', hideOnClick: false }\"\n        />\n    </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { CoreFilter, type LegendSymbology } from '@/geo/api';\nimport { onMounted, ref, type PropType } from 'vue';\nimport { useI18n } from 'vue-i18n';\nimport { LayerItem } from '../store/layer-item';\nimport { LegendItem } from '../store/legend-item';\n\nconst { t } = useI18n();\n\nconst props = defineProps({\n    value: {\n        type: Object as PropType<LegendItem | LegendSymbology>,\n        required: true\n    },\n    legendItem: {\n        type: Object as PropType<LegendItem | LayerItem>,\n        required: true\n    },\n    checked: { type: Boolean },\n    label: { type: String },\n    isRadio: { type: Boolean },\n    disabled: { type: Boolean }\n});\n\nconst initialChecked = ref(props.legendItem.visibility);\n\nonMounted(() => {\n    props.legendItem.checkVisibilityRules();\n    initialChecked.value = props.legendItem.visibility === props.checked;\n});\n\n/**\n * Returns true if none of the child symbols are visible\n * @returns {boolean} true when no child symbols are visible\n */\nconst _noSymbolsVisible = (item: LayerItem): boolean => {\n    return !item.symbologyStack.some((item: LegendSymbology) => item.visibility);\n};\n\n/**\n * Toggle this visibility of the value object linked with this checkbox\n */\nconst toggleVisibility = (): void => {\n    if (props.value instanceof LegendItem) {\n        // Toggle parent symbology checkbox\n        props.legendItem.toggleVisibility();\n    } else if (props.legendItem instanceof LayerItem) {\n        // Toggle child symbology checkbox\n        if (_noSymbolsVisible(props.legendItem)) {\n            // If no symbols are visible, then set the parent layer to visible\n            // since we toggled on one of the child symbols and set all other\n            // symbols to invisible (except for the one that is toggled on)\n            props.legendItem.setSymbologyVisibility(undefined, false);\n            props.legendItem.setSymbologyVisibility(props.value.uid, true);\n            props.legendItem.toggleVisibility(true);\n        } else {\n            // Toggle the child symbology\n            props.legendItem.setSymbologyVisibility(props.value.uid, !props.value.lastVisbility);\n        }\n\n        // If all child symbols are toggled off, then toggle off the parent layer too\n        if (_noSymbolsVisible(props.legendItem)) {\n            props.legendItem.toggleVisibility(false);\n        }\n\n        // Update the layer definition to filter child symbols\n        // At the moment, only layers that support features will support sql filters\n        if (props.legendItem.layer?.supportsFeatures) {\n            const filterGuts = props.legendItem.symbologyStack\n                .filter((item: LegendSymbology) => item.lastVisbility === true)\n                .map((item: LegendSymbology) => item.definitionClause || '');\n\n            let sql = ''; // default value, this computes to \"show all\"\n            if (filterGuts.length === 0) {\n                // nothing visible.\n                sql = '1=2';\n            } else if (filterGuts.length < props.legendItem.symbologyStack.length) {\n                // only a subset of checkboxes are checked. need filter\n                sql = filterGuts.join(' OR ');\n            }\n\n            props.legendItem.layer?.setSqlFilter(CoreFilter.SYMBOL, sql);\n        }\n        initialChecked.value = true;\n    }\n};\n</script>\n\n<style lang=\"scss\"></style>\n","<template>\n    <div @click.stop @mouseover.stop class=\"options display-block cursor-auto\">\n        <dropdown-menu\n            class=\"flex-shrink-0\"\n            position=\"bottom-end\"\n            :tooltip=\"t('legend.layer.options')\"\n            tooltipPlacement=\"left\"\n            tooltipPlacementAlt=\"left\"\n            ref=\"dropdown\"\n            :key=\"legendOptionKey\"\n        >\n            <template #header>\n                <div class=\"flex p-4 justify-center items-center\">\n                    <svg class=\"inline-block fill-current w-18 h-18 mx-4\" viewBox=\"0 0 23 21\">\n                        <path\n                            d=\"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z\"\n                        />\n                    </svg>\n                </div>\n            </template>\n            <!-- metadata -->\n            <a\n                href=\"javascript:;\"\n                class=\"flex leading-snug items-center text-left w-auto\"\n                :class=\"{\n                    disabled: !legendItem!.layerControlAvailable(LayerControl.Metadata) || !getFixtureExists('metadata')\n                }\"\n                @click=\"toggleMetadata\"\n                role=\"button\"\n                :aria-label=\"t('legend.layer.controls.metadata')\"\n            >\n                <svg class=\"setting-svg\" viewBox=\"0 0 23 21\">\n                    <path\n                        d=\"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z\"\n                    />\n                </svg>\n                {{ t('legend.layer.controls.metadata') }}\n            </a>\n            <!-- settings -->\n            <a\n                href=\"javascript:;\"\n                class=\"flex leading-snug items-center text-left w-auto\"\n                :class=\"{\n                    disabled: !legendItem!.layerControlAvailable(LayerControl.Settings) || !getFixtureExists('settings')\n                }\"\n                @click=\"toggleSettings\"\n                role=\"button\"\n                :aria-label=\"t('legend.layer.controls.settings')\"\n            >\n                <svg class=\"setting-svg\" viewBox=\"0 0 23 21\">\n                    <g>\n                        <path\n                            d=\"M 3,17L 3,19L 9,19L 9,17L 3,17 Z M 3,5L 3,7L 13,7L 13,5L 3,5 Z M 13,21L 13,19L 21,19L 21,17L 13,17L 13,15L 11,15L 11,21L 13,21 Z M 7,9L 7,11L 3,11L 3,13L 7,13L 7,15L 9,15L 9,9L 7,9 Z M 21,13L 21,11L 11,11L 11,13L 21,13 Z M 15,9L 17,9L 17,7L 21,7L 21,5L 17,5L 17,3L 15,3L 15,9 Z \"\n                        />\n                    </g>\n                </svg>\n                {{ t('legend.layer.controls.settings') }}\n            </a>\n            <!-- datatable -->\n            <a\n                href=\"javascript:;\"\n                class=\"flex leading-snug items-center text-left w-auto\"\n                :class=\"{\n                    disabled: !legendItem!.layerControlAvailable(LayerControl.Datatable) || !getFixtureExists('grid')\n                }\"\n                @click=\"toggleGrid\"\n                role=\"button\"\n                :aria-label=\"t('legend.layer.controls.datatable')\"\n            >\n                <svg class=\"setting-svg\" viewBox=\"0 0 23 21\">\n                    <path\n                        d=\"M 4.00002,3L 20,3C 21.1046,3 22,3.89543 22,5L 22,20C 22,21.1046 21.1046,22 20,22L 4.00001,22C 2.89544,22 2.00001,21.1046 2.00001,20L 2.00002,5C 2.00002,3.89543 2.89545,3 4.00002,3 Z M 4.00002,7L 4.00001,10L 8,10L 8,7.00001L 4.00002,7 Z M 10,7.00001L 9.99999,10L 14,10L 14,7.00001L 10,7.00001 Z M 20,10L 20,7L 16,7.00001L 16,10L 20,10 Z M 4.00002,12L 4.00002,15L 8,15L 8,12L 4.00002,12 Z M 4.00001,20L 8,20L 8,17L 4.00002,17L 4.00001,20 Z M 9.99999,12L 9.99999,15L 14,15L 14,12L 9.99999,12 Z M 9.99999,20L 14,20L 14,17L 9.99999,17L 9.99999,20 Z M 20,20L 20,17L 16,17L 16,20L 20,20 Z M 20,12L 16,12L 16,15L 20,15L 20,12 Z \"\n                    />\n                </svg>\n                {{ t('legend.layer.controls.datatable') }}\n            </a>\n            <!-- symbology stack -->\n            <a\n                href=\"javascript:;\"\n                class=\"flex leading-snug items-center text-left w-auto\"\n                :class=\"{\n                    disabled: !legendItem!.layerControlAvailable(LayerControl.Symbology)\n                }\"\n                @click=\"toggleSymbology\"\n                role=\"button\"\n                :aria-label=\"t('legend.layer.controls.symbology')\"\n            >\n                <svg class=\"setting-svg\" viewBox=\"0 0 23 21\">\n                    <path\n                        d=\"M11.99 18.54l-7.37-5.73L3 14.07l9 7 9-7-1.63-1.27-7.38 5.74zM12 16l7.36-5.73L21 9l-9-7-9 7 1.63 1.27L12 16z\"\n                    />\n                </svg>\n                {{ t('legend.layer.controls.symbology') }}\n            </a>\n            <!-- boundary zoom -->\n            <a\n                href=\"javascript:;\"\n                class=\"flex leading-snug items-center text-left w-auto\"\n                :class=\"{\n                    disabled: !legendItem!.layerControlAvailable(LayerControl.BoundaryZoom)\n                }\"\n                @click=\"zoomToLayerBoundary\"\n                role=\"button\"\n                :aria-label=\"t('legend.layer.controls.boundaryzoom')\"\n            >\n                <svg class=\"setting-svg\" viewBox=\"0 0 24 24\">\n                    <path\n                        d=\"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z\"\n                    />\n                    <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n                    <path d=\"M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z\" />\n                </svg>\n                {{ t('legend.layer.controls.boundaryzoom') }}\n            </a>\n            <!-- remove -->\n            <a\n                href=\"javascript:;\"\n                class=\"flex leading-snug items-center text-left w-auto\"\n                :class=\"{\n                    disabled: !legendItem!.layerControlAvailable(LayerControl.Remove)\n                }\"\n                @click=\"removeLayer\"\n                role=\"button\"\n                :aria-label=\"t('legend.layer.controls.remove')\"\n            >\n                <svg class=\"setting-svg\" viewBox=\"0 0 23 21\">\n                    <path d=\"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z\"></path>\n                </svg>\n                {{ t('legend.layer.controls.remove') }}\n            </a>\n            <!-- reload -->\n            <a\n                href=\"javascript:;\"\n                class=\"flex leading-snug items-center text-left w-auto\"\n                :class=\"{\n                    disabled: !reloadableLayer\n                }\"\n                :content=\"!reloadableLayer ? t('legend.layer.controls.reloadDisabled') : ''\"\n                @mouseover.stop=\"hover($event.currentTarget!)\"\n                @mouseout=\"\n                    //@ts-expect-error TODO: explain why this is needed or remove\n                    mobileMode ? null : $event.currentTarget?._tippy?.hide(), (hovered = false)\n                \"\n                v-tippy=\"{\n                    placement: 'top-start',\n                    trigger: 'manual focus',\n                    aria: 'describedby'\n                }\"\n                @click=\"e => reloadLayer(e as PointerEvent)\"\n                role=\"button\"\n                :aria-label=\"t('legend.layer.controls.reload')\"\n            >\n                <svg class=\"setting-svg\" viewBox=\"0 0 24 24\">\n                    <path\n                        d=\"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z\"\n                    ></path>\n                </svg>\n                {{ t('legend.layer.controls.reload') }}\n            </a>\n        </dropdown-menu>\n    </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { GlobalEvents, InstanceAPI } from '@/api';\nimport { LayerControl } from '@/geo/api';\nimport { computed, inject, ref, toRaw } from 'vue';\nimport { useI18n } from 'vue-i18n';\nimport { LayerItem } from '../store/layer-item';\nimport { usePanelStore } from '@/stores/panel';\n\nconst { t } = useI18n();\nconst iApi = inject('iApi') as InstanceAPI;\nconst dropdown = ref();\nconst hovered = ref(false);\nconst panelStore = usePanelStore();\nconst mobileMode = ref(panelStore.mobileView);\nconst emit = defineEmits(['focusItem']);\nconst legendOptionKey = ref(0);\n\nconst props = defineProps({\n    legendItem: LayerItem\n});\n\n/**\n * Display symbology stack for the layer.\n */\nconst toggleSymbology = (): void => {\n    if (props.legendItem!.layerControlAvailable(LayerControl.Symbology)) {\n        props.legendItem!.toggleSymbology();\n    }\n};\n\n/**\n * Toggles data table panel to open/close for the LegendItem.\n */\nconst toggleGrid = () => {\n    if (props.legendItem!.layerControlAvailable(LayerControl.Datatable) && getFixtureExists('grid')) {\n        iApi.event.emit(GlobalEvents.GRID_TOGGLE, props.legendItem!.layer);\n    }\n};\n\n/**\n * Toggles settings panel to open/close type for the LegendItem.\n */\nconst toggleSettings = () => {\n    if (props.legendItem!.layerControlAvailable(LayerControl.Settings) && getFixtureExists('settings')) {\n        iApi.event.emit(GlobalEvents.SETTINGS_TOGGLE, props.legendItem!.layer);\n    }\n};\n\n/**\n * Toggles metadata panel to open/close for the LegendItem.\n */\nconst toggleMetadata = () => {\n    if (props.legendItem!.layerControlAvailable(LayerControl.Metadata) && getFixtureExists('metadata')) {\n        const metaConfig =\n            props.legendItem?.layer?.config.metadata || props.legendItem?.layer?.parentLayer?.config?.metadata || {};\n        const name = metaConfig?.name || props.legendItem?.layer?.name || '';\n        const catalogueUrl =\n            props.legendItem?.layer?.config?.catalogueUrl ||\n            (props.legendItem?.layer?.layerType === 'sublayer' &&\n                props.legendItem?.layer?.parentLayer?.config?.catalogueUrl) ||\n            undefined;\n\n        if (metaConfig.url) {\n            // Check the file extension to see if this is an XML file. Defaults to HTML.\n            const parseUrl = metaConfig.url.split('.');\n            const metadataExtension = parseUrl[parseUrl.length - 1];\n            const metadataType = metadataExtension === 'xml' || metadataExtension === 'md' ? metadataExtension : 'html';\n\n            // TODO: toggle metadata panel through API/store call\n            iApi.event.emit(GlobalEvents.METADATA_TOGGLE, {\n                type: metadataType,\n                layerName: name,\n                url: metaConfig.url,\n                catalogueUrl: catalogueUrl,\n                layer: props.legendItem!.layer\n            });\n        } else {\n            console.warn('Layer does not have a metadata url defined');\n        }\n    }\n};\n\n/**\n * Zoom to the boundary of layer\n */\nconst zoomToLayerBoundary = () => {\n    if (props.legendItem!.layerControlAvailable(LayerControl.BoundaryZoom)) {\n        props.legendItem?.layer?.zoomToLayerBoundary();\n    }\n};\n\n/**\n * Removes layer from map.\n */\nconst removeLayer = () => {\n    if (props.legendItem!.layerControlAvailable(LayerControl.Remove)) {\n        iApi.geo.map.removeLayer(props.legendItem!.layerUid!);\n    }\n};\n\n/**\n * Reloads a layer on the map.\n *\n * @param {PointerEvent} e the PointerEvent corresponding to the reload button being clicked/pressed\n */\nconst reloadLayer = (e: PointerEvent) => {\n    if (reloadableLayer.value) {\n        toRaw(props.legendItem!.layer!)\n            .reload()\n            .then(() => {\n                legendOptionKey.value += 1;\n                if (e.pointerType !== 'mouse') {\n                    emit('focusItem');\n                }\n            });\n    }\n};\n\n/**\n * Determine if the layer can be reloaded\n */\nconst reloadableLayer = computed((): boolean => {\n    return (\n        props.legendItem!.layerControlAvailable(LayerControl.Reload) &&\n        props.legendItem instanceof LayerItem &&\n        toRaw(props.legendItem!.layer)?.canReload\n    );\n});\n\nconst hover = (t: EventTarget) => {\n    hovered.value = true;\n    setTimeout(() => {\n        if (hovered.value) {\n            if (!mobileMode.value) {\n                //@ts-expect-error TODO: explain why this is needed or remove\n                t._tippy?.show();\n            }\n        }\n    }, 300);\n};\n\n/**\n * Indicates if the fixture with the given name has been added\n */\nconst getFixtureExists = (fixtureName: string): boolean => {\n    try {\n        return iApi.fixture.exists(fixtureName);\n    } catch {\n        return false;\n    }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.disabled {\n    @apply text-neutral-500 cursor-default;\n}\n.setting-svg {\n    margin-bottom: 5px;\n    display: inline-block;\n    fill: currentColor;\n    width: 18px;\n    height: 18px;\n    margin-right: 10px;\n}\n</style>\n","<template>\n    <div v-if=\"!visible\">\n        <!-- Multiple icons to display -->\n        <div v-if=\"stack.length > 1\" class=\"relative left-3\">\n            <!-- the :class line calculates margin-left for each of the 3 symbols, and gives a margin-top to symbols that arent the first -->\n            <div\n                class=\"absolute\"\n                :class=\"[idx == 0 ? 'symbol-0' : idx == 1 ? 'left-3 symbol-1' : 'left-6 symbol-2']\"\n                :style=\"{ 'z-index': 3 - idx }\"\n                v-for=\"(item, idx) in stack.slice(0, 3).reverse()\"\n                :key=\"idx\"\n            >\n                <span v-if=\"stack[idx].svgcode\" class=\"symbologyIcon w-28 h-28\" v-html=\"stack[idx].svgcode\"></span>\n                <img v-else-if=\"stack[idx].imgUrl\" class=\"symbologyIcon w-28 h-28\" :src=\"stack[idx].imgUrl\" />\n            </div>\n        </div>\n\n        <!-- Only one icon to display. -->\n        <div v-else-if=\"stack.length > 0\" class=\"symbologyIcon w-32 h-32\">\n            <span v-if=\"stack[0].svgcode\" v-html=\"stack[0].svgcode\"></span>\n            <img v-else-if=\"stack[0].imgUrl\" class=\"symbologyIcon w-full h-full\" :src=\"stack[0].imgUrl\" />\n        </div>\n    </div>\n\n    <!-- If the symbology stack is already open, display an X in the place of the stack. -->\n    <div v-else class=\"h-32 w-32 inline-flex justify-center items-center\">\n        <svg class=\"fill-current w-16 h-16\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 352 512\">\n            <path\n                d=\"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z\"\n            />\n        </svg>\n    </div>\n</template>\n\n<script setup lang=\"ts\">\nimport type { LegendSymbology } from '@/geo/api';\nimport { toRaw, onMounted, type PropType, ref } from 'vue';\nimport type { LayerItem } from '../store/layer-item';\n\nconst props = defineProps({\n    visible: { type: Boolean, required: true },\n    legendItem: { type: Object as PropType<LayerItem>, required: true }\n});\n\nconst stack = ref<Array<LegendSymbology>>([]); // ref instead of reactive to maintain reactivity after promise\n\nonMounted(() => {\n    // wait for the layer item to load\n    props.legendItem.loadPromise.then(() => {\n        if (props.legendItem.layerUid !== undefined) {\n            // retrieve the symbology stack\n            // waits on all symbols in the stack to finish loading before displaying.\n            Promise.all(toRaw(props.legendItem.symbologyStack).map((l: any) => l.drawPromise)).then(() => {\n                stack.value = toRaw(props.legendItem).symbologyStack;\n            });\n        }\n    });\n});\n</script>\n\n<style lang=\"scss\" scoped>\n.symbol-0 {\n    :hover > & {\n        transform: rotate(-10deg);\n        transform-origin: bottom center;\n    }\n}\n.symbol-2 {\n    :hover > & {\n        transform: rotate(10deg);\n        transform-origin: bottom center;\n    }\n}\n.ramp-styles.animation-enabled .symbol-0 {\n    transition-duration: 0.2s;\n}\n.ramp-styles.animation-enabled .symbol-2 {\n    transition-duration: 0.2s;\n}\n</style>\n","<template>\n    <MiniIcon\n        :label=\"featureCount ? featureCount.toString() : ''\"\n        :content=\"layerData[0] + featCountText\"\n        v-tippy=\"{ placement: 'bottom-start' }\"\n    >\n        <div v-html=\"layerData[1]\"></div>\n    </MiniIcon>\n</template>\n\n<script setup lang=\"ts\">\nimport { LayerType } from '@/geo/api';\nimport { computed, type PropType } from 'vue';\nimport MiniIcon from './mini-icon.vue';\nimport { useI18n } from 'vue-i18n';\n\nconst { t } = useI18n();\n\nconst props = defineProps({\n    layerType: { type: String as PropType<LayerType>, required: true },\n    featureCount: { type: Number }\n});\n\nconst featCountText = computed(() =>\n    props.featureCount ? ` (${t('legend.layer.features.count', props.featureCount)})` : ''\n);\n\n/**\n\n Converts the layer type provided to the corresponding icon/text for the mini-icon.\n\n The following layers are implemented:\n - ESRI Feature Layer (`esri-feature`)\n - ESRI Map Image Layer (formerly known as Dynamic Layer) (`esri-map-image`)\n - ESRI Tile Layer (`esri-tile`)\n - ESRI Image Service (`esri-imagery`)\n - ESRI Graphic Layer (`esri-graphic`)\n - OGC WFS 3.0 (`ogc-wfs`)\n - OGC WMS (`ogc-wms`)\n - GeoJSON (`file-geojson`)\n - CSV File (`file-csv`)\n - Shapefile (`file-shape`)\n - OpenStreetMap Tile Layer (`osm-tile`)\n - ESRI Table Layer (`data-esri-table`)\n - Non Spatial CSV File (`data-csv`)\n - Compact JSON File (`data-json`)\n - A catch-all for unknown layer types.\n\n @returns An array with two items. The first is text describing the layer type; the second is text representing an SVG of the layer type.\n\n */\nconst layerData = computed(() => {\n    switch (props.layerType) {\n        case LayerType.FEATURE:\n            return [\n                t('legend.layer.type.ESRIFeature'),\n                `<svg\n                    version=\"1.1\"\n                    id=\"Layer_1\"\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n                    x=\"0px\"\n                    y=\"0px\"\n                    width=\"12px\"\n                    height=\"12px\"\n                    viewBox=\"0 0 92.25 122.88\"\n                    style=\"enable-background: new 0 0 92.25 122.88\"\n                    xml:space=\"preserve\"\n                >\n                    <g>\n                        <path\n                            fill-rule=\"evenodd\"\n                            clip-rule=\"evenodd\"\n                            class=\"st0\"\n                            d=\"M68.51,106.28c-5.59,6.13-12.1,11.62-19.41,16.06c-0.9,0.66-2.12,0.74-3.12,0.1 c-10.8-6.87-19.87-15.12-27-24.09C9.14,86.01,2.95,72.33,0.83,59.15c-2.16-13.36-0.14-26.22,6.51-36.67 c2.62-4.13,5.97-7.89,10.05-11.14C26.77,3.87,37.48-0.08,48.16,0c10.28,0.08,20.43,3.91,29.2,11.92c3.08,2.8,5.67,6.01,7.79,9.49 c7.15,11.78,8.69,26.8,5.55,42.02c-3.1,15.04-10.8,30.32-22.19,42.82V106.28L68.51,106.28z M46.12,23.76 c12.68,0,22.95,10.28,22.95,22.95c0,12.68-10.28,22.95-22.95,22.95c-12.68,0-22.95-10.27-22.95-22.95 C23.16,34.03,33.44,23.76,46.12,23.76L46.12,23.76z\"\n                        />\n                    </g>\n                </svg>`\n            ];\n        case LayerType.MAPIMAGE:\n            return [\n                t('legend.layer.type.ESRIMapImage'),\n                `<svg\n                    version=\"1.1\"\n                    width=\"12px\"\n                    height=\"12px\"\n                    id=\"Layer_1\"\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n                    x=\"0px\"\n                    y=\"0px\"\n                    viewBox=\"0 0 122.88 122.151\"\n                    enable-background=\"new 0 0 122.88 122.151\"\n                    xml:space=\"preserve\"\n                >\n                    <g>\n                        <path d=\"M8.676,0h105.529c2.405,0,4.557,0.984,6.124,2.552c1.567,1.567,2.551,3.754,2.551,6.124v104.8 c0,2.405-0.983,4.557-2.551,6.124c-1.568,1.567-3.755,2.552-6.124,2.552H8.676c-2.406,0-4.557-0.984-6.124-2.553 C0.984,118.032,0,115.845,0,113.476V8.675C0,6.27,0.984,4.119,2.552,2.552C4.12,0.984,6.307,0,8.676,0L8.676,0z M9.097,88.323 l35.411-33.9c1.421-1.313,3.645-1.167,4.921,0.255c0.037,0.036,0.037,0.073,0.073,0.073l31.459,37.218l4.812-29.6 c0.328-1.896,2.114-3.208,4.01-2.879c0.729,0.109,1.385,0.474,1.895,0.948l22.07,23.184V10.773c0-0.474-0.183-0.875-0.511-1.166 c-0.291-0.292-0.729-0.511-1.166-0.511H10.737c-0.474,0-0.875,0.182-1.166,0.511c-0.292,0.291-0.511,0.729-0.511,1.166v77.55H9.097 L9.097,88.323z M90.526,19.866c3.464,0,6.635,1.422,8.895,3.682c2.297,2.296,3.682,5.431,3.682,8.895 c0,3.463-1.421,6.634-3.682,8.894c-2.296,2.297-5.431,3.682-8.895,3.682c-3.462,0-6.634-1.421-8.894-3.682 c-2.297-2.296-3.682-5.431-3.682-8.894c0-3.463,1.421-6.634,3.682-8.895C83.929,21.251,87.064,19.866,90.526,19.866L90.526,19.866z\"/>\n                    </g>\n                </svg>`\n            ];\n        case LayerType.TILE:\n            return [\n                t('legend.layer.type.ESRITile'),\n                `<svg\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    width=\"12px\"\n                    height=\"12px\"\n                    shape-rendering=\"geometricPrecision\"\n                    text-rendering=\"geometricPrecision\"\n                    image-rendering=\"optimizeQuality\"\n                    fill-rule=\"evenodd\"\n                    clip-rule=\"evenodd\"\n                    viewBox=\"0 0 512 481.157\"\n                >\n                    <path d=\"M35.64 0h159.702c19.604 0 35.641 16.037 35.641 35.64v145.308c0 19.604-16.037 35.64-35.641 35.64H35.64c-19.603 0-35.64-16.036-35.64-35.64V35.64C0 16.037 16.037 0 35.64 0zm281.017 264.569h159.702c19.604 0 35.641 16.036 35.641 35.64v145.307c0 19.604-16.037 35.641-35.641 35.641H316.657c-19.603 0-35.64-16.037-35.64-35.641V300.209c0-19.604 16.037-35.64 35.64-35.64zm-281.017 0h159.702c19.604 0 35.641 16.036 35.641 35.64v145.307c0 19.604-16.037 35.641-35.641 35.641H35.64C16.037 481.157 0 465.12 0 445.516V300.209c0-19.604 16.037-35.64 35.64-35.64zM316.657 0h159.702C495.963 0 512 16.037 512 35.64v145.308c0 19.604-16.037 35.64-35.641 35.64H316.657c-19.603 0-35.64-16.036-35.64-35.64V35.64c0-19.603 16.037-35.64 35.64-35.64z\"/>\n                </svg>`\n            ];\n        case LayerType.IMAGERY:\n            return [\n                t('legend.layer.type.ESRIImagery'),\n                `<svg\n                    version=\"1.1\"\n                    width=\"12px\"\n                    height=\"12px\"\n                    id=\"Layer_1\"\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n                    x=\"0px\"\n                    y=\"0px\"\n                    viewBox=\"0 0 122.88 122.151\"\n                    enable-background=\"new 0 0 122.88 122.151\"\n                    xml:space=\"preserve\"\n                >\n                    <g>\n                        <path d=\"M8.676,0h105.529c2.405,0,4.557,0.984,6.124,2.552c1.567,1.567,2.551,3.754,2.551,6.124v104.8 c0,2.405-0.983,4.557-2.551,6.124c-1.568,1.567-3.755,2.552-6.124,2.552H8.676c-2.406,0-4.557-0.984-6.124-2.553 C0.984,118.032,0,115.845,0,113.476V8.675C0,6.27,0.984,4.119,2.552,2.552C4.12,0.984,6.307,0,8.676,0L8.676,0z M9.097,88.323 l35.411-33.9c1.421-1.313,3.645-1.167,4.921,0.255c0.037,0.036,0.037,0.073,0.073,0.073l31.459,37.218l4.812-29.6 c0.328-1.896,2.114-3.208,4.01-2.879c0.729,0.109,1.385,0.474,1.895,0.948l22.07,23.184V10.773c0-0.474-0.183-0.875-0.511-1.166 c-0.291-0.292-0.729-0.511-1.166-0.511H10.737c-0.474,0-0.875,0.182-1.166,0.511c-0.292,0.291-0.511,0.729-0.511,1.166v77.55H9.097 L9.097,88.323z M90.526,19.866c3.464,0,6.635,1.422,8.895,3.682c2.297,2.296,3.682,5.431,3.682,8.895 c0,3.463-1.421,6.634-3.682,8.894c-2.296,2.297-5.431,3.682-8.895,3.682c-3.462,0-6.634-1.421-8.894-3.682 c-2.297-2.296-3.682-5.431-3.682-8.894c0-3.463,1.421-6.634,3.682-8.895C83.929,21.251,87.064,19.866,90.526,19.866L90.526,19.866z\"/>\n                    </g>\n                </svg>`\n            ];\n        case LayerType.GRAPHIC:\n            return [\n                t('legend.layer.type.ESRIGraphic'),\n                `<svg\n                    version=\"1.1\"\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n                    x=\"0px\"\n                    y=\"0px\"\n                    viewBox=\"0 0 122.88 122.88\"\n                    style=\"enable-background:new 0 0 122.88 122.88\"\n                    xml:space=\"preserve\"\n                >\n                    <g>\n                        <path\n                            class=\"st0\"\n                            fill-rule=\"evenodd\"\n                            clip-rule=\"evenodd\"\n                            d=\"M61.44,0c33.93,0,61.44,27.51,61.44,61.44c0,33.93-27.51,61.44-61.44,61.44S0,95.37,0,61.44 C0,27.51,27.51,0,61.44,0L61.44,0z M52.56,84c-1.82,0.61-3.68,1.17-5.5,1.77c-1.82,0.61-3.64,1.21-5.5,1.82 c-4.34,1.4-6.71,2.19-7.23,2.33c-0.51,0.14-0.19-1.86,0.89-6.06l3.45-13.19l26.01-27.04l13.85,13.33L52.56,84L52.56,84L52.56,84z M78.48,33.84c-0.65-0.61-1.4-0.93-2.24-0.89c-0.84,0-1.59,0.33-2.19,0.98l-4.94,5.13l13.85,13.38l4.99-5.22 c0.61-0.61,0.84-1.4,0.84-2.24c0-0.84-0.33-1.63-0.93-2.19L78.48,33.84L78.48,33.84L78.48,33.84z\"\n                        />\n                    </g>\n                </svg>`\n            ];\n        case LayerType.WFS:\n            return [\n                t('legend.layer.type.wfs'),\n                `<svg\n                    version=\"1.1\"\n                    width=\"12px\"\n                    height=\"12px\"\n                    id=\"Layer_1\"\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n                    x=\"0px\"\n                    y=\"0px\"\n                    viewBox=\"0 0 122.88 122.151\"\n                    enable-background=\"new 0 0 122.88 122.151\"\n                    xml:space=\"preserve\"\n                >\n                    <g>\n                        <path d=\"M8.676,0h105.529c2.405,0,4.557,0.984,6.124,2.552c1.567,1.567,2.551,3.754,2.551,6.124v104.8 c0,2.405-0.983,4.557-2.551,6.124c-1.568,1.567-3.755,2.552-6.124,2.552H8.676c-2.406,0-4.557-0.984-6.124-2.553 C0.984,118.032,0,115.845,0,113.476V8.675C0,6.27,0.984,4.119,2.552,2.552C4.12,0.984,6.307,0,8.676,0L8.676,0z M9.097,88.323 l35.411-33.9c1.421-1.313,3.645-1.167,4.921,0.255c0.037,0.036,0.037,0.073,0.073,0.073l31.459,37.218l4.812-29.6 c0.328-1.896,2.114-3.208,4.01-2.879c0.729,0.109,1.385,0.474,1.895,0.948l22.07,23.184V10.773c0-0.474-0.183-0.875-0.511-1.166 c-0.291-0.292-0.729-0.511-1.166-0.511H10.737c-0.474,0-0.875,0.182-1.166,0.511c-0.292,0.291-0.511,0.729-0.511,1.166v77.55H9.097 L9.097,88.323z M90.526,19.866c3.464,0,6.635,1.422,8.895,3.682c2.297,2.296,3.682,5.431,3.682,8.895 c0,3.463-1.421,6.634-3.682,8.894c-2.296,2.297-5.431,3.682-8.895,3.682c-3.462,0-6.634-1.421-8.894-3.682 c-2.297-2.296-3.682-5.431-3.682-8.894c0-3.463,1.421-6.634,3.682-8.895C83.929,21.251,87.064,19.866,90.526,19.866L90.526,19.866z\"/>\n                    </g>\n                </svg>`\n            ];\n        case LayerType.WMS:\n            return [\n                t('legend.layer.type.wms'),\n                `<svg\n                    version=\"1.1\"\n                    width=\"12px\"\n                    height=\"12px\"\n                    id=\"Layer_1\"\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n                    x=\"0px\"\n                    y=\"0px\"\n                    viewBox=\"0 0 122.88 122.151\"\n                    enable-background=\"new 0 0 122.88 122.151\"\n                    xml:space=\"preserve\"\n                >\n                    <g>\n                        <path d=\"M8.676,0h105.529c2.405,0,4.557,0.984,6.124,2.552c1.567,1.567,2.551,3.754,2.551,6.124v104.8 c0,2.405-0.983,4.557-2.551,6.124c-1.568,1.567-3.755,2.552-6.124,2.552H8.676c-2.406,0-4.557-0.984-6.124-2.553 C0.984,118.032,0,115.845,0,113.476V8.675C0,6.27,0.984,4.119,2.552,2.552C4.12,0.984,6.307,0,8.676,0L8.676,0z M9.097,88.323 l35.411-33.9c1.421-1.313,3.645-1.167,4.921,0.255c0.037,0.036,0.037,0.073,0.073,0.073l31.459,37.218l4.812-29.6 c0.328-1.896,2.114-3.208,4.01-2.879c0.729,0.109,1.385,0.474,1.895,0.948l22.07,23.184V10.773c0-0.474-0.183-0.875-0.511-1.166 c-0.291-0.292-0.729-0.511-1.166-0.511H10.737c-0.474,0-0.875,0.182-1.166,0.511c-0.292,0.291-0.511,0.729-0.511,1.166v77.55H9.097 L9.097,88.323z M90.526,19.866c3.464,0,6.635,1.422,8.895,3.682c2.297,2.296,3.682,5.431,3.682,8.895 c0,3.463-1.421,6.634-3.682,8.894c-2.296,2.297-5.431,3.682-8.895,3.682c-3.462,0-6.634-1.421-8.894-3.682 c-2.297-2.296-3.682-5.431-3.682-8.894c0-3.463,1.421-6.634,3.682-8.895C83.929,21.251,87.064,19.866,90.526,19.866L90.526,19.866z\"/>\n                    </g>\n                </svg>`\n            ];\n        case LayerType.GEOJSON:\n            return [\n                t('legend.layer.type.geoJson'),\n                `<svg\n                    version=\"1.1\"\n                    id=\"Layer_1\"\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n                    x=\"0px\"\n                    y=\"0px\"\n                    viewBox=\"0 0 115.16 122.88\"\n                    style=\"enable-background:new 0 0 115.16 122.88\"\n                    xml:space=\"preserve\"\n                    width=\"12px\"\n                    height=\"12px\"\n                >\n                    <g>\n                        <path d=\"M0,69.1V53.79c4.65-0.04,8.13-1.42,10.49-4.12C12.82,46.96,14,40.87,14,31.41c0-7.22,0.26-12.56,0.81-16.03 c0.52-3.47,1.81-6.39,3.86-8.73c2.05-2.35,4.69-4.03,7.92-5.08C29.81,0.52,34.4,0,40.33,0h3.38v15.31c-6.2,0-9.9,0.63-11.12,1.92 c-1.22,1.27-1.88,3.77-1.96,7.48c-0.26,10.21-0.59,16.86-0.98,19.93c-0.41,3.05-1.35,5.98-2.81,8.77 c-1.46,2.79-4.19,5.47-8.18,8.03c3.8,2.31,6.54,5.06,8.24,8.24c1.72,3.21,2.75,7.81,3.03,13.83l0.96,18.63 c0.39,1.79,1.31,3.14,2.77,4.06c1.46,0.92,4.82,1.37,10.06,1.37v15.31h-3.34c-6.83,0-12.08-0.78-15.81-2.33 c-3.71-1.55-6.39-4.1-8.07-7.63c-1.66-3.55-2.49-9.27-2.49-17.14c0-8.7-0.31-14.26-0.89-16.71c-0.59-2.42-1.74-4.65-3.45-6.67 C7.94,70.36,4.73,69.27,0,69.1L0,69.1z M115.16,69.1c-4.65,0.04-8.14,1.42-10.49,4.17c-2.33,2.73-3.51,8.77-3.51,18.15 c0,7.26-0.26,12.61-0.76,16.1c-0.52,3.47-1.79,6.39-3.84,8.72c-2.05,2.36-4.71,4.03-7.94,5.08c-3.25,1.05-7.83,1.57-13.76,1.57 h-3.4v-15.31c5.95,0,9.6-0.61,10.93-1.85c1.35-1.24,2.07-3.75,2.16-7.55c0.26-10.93,0.65-17.93,1.18-21.03 c0.55-3.1,1.59-5.98,3.21-8.66c1.59-2.7,4.12-5.04,7.57-7.05c-3.64-2.38-6.19-4.73-7.63-7.02c-1.44-2.31-2.42-4.8-2.92-7.5 c-0.5-2.7-0.89-7.74-1.16-15.09c-0.24-7.35-0.55-11.56-0.9-12.61c-0.33-1.07-1.16-1.98-2.46-2.75c-1.31-0.76-4.62-1.16-9.97-1.16V0 h3.38c6.83,0,12.08,0.79,15.79,2.33c3.71,1.55,6.39,4.1,8.05,7.63c1.66,3.56,2.49,9.27,2.49,17.14c0,9.05,0.33,14.74,0.98,17.08 c0.68,2.36,1.83,4.49,3.53,6.43c1.68,1.94,4.84,2.99,9.49,3.16V69.1L115.16,69.1z\"/>\n                    </g>\n                </svg>`\n            ];\n        case LayerType.CSV:\n            return [\n                t('legend.layer.type.csv'),\n                `<svg\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    shape-rendering=\"geometricPrecision\"\n                    text-rendering=\"geometricPrecision\"\n                    image-rendering=\"optimizeQuality\"\n                    fill-rule=\"evenodd\"\n                    clip-rule=\"evenodd\"\n                    viewBox=\"0 0 392 512.309\"\n                    width=\"12px\"\n                    height=\"12px\"\n                >\n                    <path d=\"M58.883 0h186.242v93.425l.099 1.406c1.618 22.2 9.835 40.061 24.454 52.552 14.088 12.047 33.864 18.745 59.129 19.14l63.193.036v286.86c0 32.331-26.552 58.89-58.883 58.89H58.883C26.545 512.309 0 485.814 0 453.419V58.883C0 26.495 26.495 0 58.883 0zm48.892 412.172c-5.673 0-10.28-4.607-10.28-10.28 0-5.674 4.607-10.28 10.28-10.28h141.71c5.673 0 10.28 4.606 10.28 10.28 0 5.673-4.607 10.28-10.28 10.28h-141.71zm0-175.532c-5.673 0-10.28-4.607-10.28-10.28 0-5.674 4.607-10.28 10.28-10.28h176.45c5.673 0 10.28 4.606 10.28 10.28 0 5.673-4.607 10.28-10.28 10.28h-176.45zm0 84.77c-5.673 0-10.28-4.607-10.28-10.28 0-5.674 4.607-10.28 10.28-10.28h167.102c5.674 0 10.281 4.606 10.281 10.28 0 5.673-4.607 10.28-10.281 10.28H107.775zM265.685 3.159L392 139.816v6.197l-63.03.035c-20.179-.346-35.532-5.327-45.967-14.251-10.288-8.796-16.109-21.853-17.318-38.414V3.159z\"/>\n                </svg>`\n            ];\n        case LayerType.SHAPEFILE:\n            return [\n                t('legend.layer.type.shapefile'),\n                `<svg\n                    version=\"1.1\"\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n                    x=\"0px\"\n                    y=\"0px\"\n                    viewBox=\"0 0 106.42 122.88\"\n                    style=\"enable-background:new 0 0 106.42 122.88\"\n                    xml:space=\"preserve\"\n                    width=\"12px\"\n                    height=\"12px\"\n                >\n                    <g>\n                        <polygon file-rule=\"evenodd\" clip-rule=\"evenodd\" class=\"st0\" points=\"53.21,0 79.81,15.36 106.42,30.72 106.42,61.44 106.42,92.16 79.81,107.52 53.21,122.88 26.6,107.52 0,92.16 0,61.44 0,30.72 26.6,15.36 53.21,0\"/>\n                    </g>\n                </svg>`\n            ];\n        case LayerType.OSM:\n            return [\n                t('legend.layer.type.osm'),\n                `<svg\n                    version=\"1.1\"\n                    id=\"Layer_1\"\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n                    x=\"0px\"\n                    y=\"0px\"\n                    width=\"12px\"\n                    height=\"12px\"\n                    viewBox=\"0 0 122.88 122.88\"\n                    enable-background=\"new 0 0 122.88 122.88\"\n                    xml:space=\"preserve\"\n                >\n                    <g>\n                        <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M61.439,0c33.928,0,61.44,27.513,61.44,61.439c0,33.929-27.513,61.44-61.44,61.44 C27.512,122.88,0,95.368,0,61.439C0,27.513,27.512,0,61.439,0L61.439,0z M78.314,6.495c20.618,6.853,36.088,24.997,39.068,47.101 l-1.953-0.209c-0.347,1.495-0.666,1.533-0.666,3.333c0,1.588,2,2.651,2,6.003c0,0.898-2.109,2.694-2.202,3.007l-3.132-3.674v4.669 l-0.476-0.018l-0.844-8.615l-1.749,0.551l-2.081-6.409l-6.855,7.155l-0.082,5.239l-2.238,1.501l-2.377-13.438l-1.422,1.039 l-3.22-4.345l-4.813,0.143l-1.844-2.107l-1.887,0.519l-3.712-4.254l-0.717,0.488l2.3,5.878h2.669v-1.334h1.333 c0.962,2.658,2.001,1.084,2.001,2.669c0,5.547-6.851,9.625-11.339,10.669c0.24,1.003,0.147,2.003,1.333,2.003 c2.513,0,1.264-0.44,4.003-0.667c-0.127,5.667-6.5,12.435-9.221,16.654l1.218,8.69c0.321,1.887-3.919,3.884-5.361,6.009 l0.692,3.329l-1.953,0.789c-0.342,3.42-3.662,7.214-7.386,7.214h-4c0-4.683-3.336-11.366-3.336-14.675 c0-2.81,1.333-3.188,1.333-6.669c0-3.216-3.333-7.828-3.333-8.67v-5.336h-2.669c-0.396-1.487-0.154-2-2-2h-0.667 c-2.914,0-2.422,1.333-5.336,1.333h-2.669c-2.406,0-6.669-7.721-6.669-8.671v-8.003c0-3.454,3.161-7.214,5.336-8.672v-3.333 l3.002-3.052l1.667-0.284c3.579,0,3.154-2,5.336-2H49.4v4.669L56,43.532l0.622-2.848c2.991,0.701,3.769,2.032,7.454,2.032h1.333 c2.531,0,2.667-3.358,2.667-6.002l-5.343,0.528l-2.324-5.064l-2.311,0.615c0.415,1.812,0.642,1.059,0.642,2.587 c0,0.9-0.741,1-1.335,1.334l-2.311-5.865l-4.969-3.549l-0.66,0.648l4.231,4.452c-0.562,1.597-0.628,6.209-2.961,2.979l2.182-1.05 l-5.438-5.699l-3.258,1.274l-3.216,3.08c-0.336,2.481-1.012,3.729-3.608,3.729c-1.728,0-0.685-0.447-3.336-0.667v-6.669h6.002 l-1.945-4.442l-0.721,0.44V24.04l9.747-4.494c-0.184-1.399-0.408-0.649-0.408-2.175c0-0.091,0.655-1.322,0.667-1.336l2.521,1.565 l-0.603-2.871l-3.889,0.8l-0.722-3.49c3.084-1.624,9.87-7.34,12.028-7.34h2.002c2.107,0,7.751,2.079,8.669,3.333L62.057,7.49 l3.971,3.271l0.381-1.395l2.964-0.812l0.036-1.855h1.336v2L78.314,6.495L78.314,6.495z M116.963,71.835 c-0.154,0.842-0.324,1.676-0.512,2.504l-0.307-2.152L116.963,71.835L116.963,71.835z M115.042,79.398 c-0.147,0.446-0.297,0.894-0.455,1.336h-0.49v-1.336H115.042L115.042,79.398z M11.758,93.18 c-3.624-5.493-6.331-11.641-7.916-18.226l10.821,5.218l0.055,3.229c0,1.186-2.025,3.71-2.667,4.669L11.758,93.18L11.758,93.18z\"/>\n                    </g>\n                </svg>`\n            ];\n        case LayerType.DATATABLE:\n            return [\n                t('legend.layer.type.datatable'),\n                `<svg\n                    version=\"1.1\"\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n                    x=\"0px\"\n                    y=\"0px\"\n                    viewBox=\"0 0 122.88 108.01\"\n                    style=\"enable-background:new 0 0 122.88 108.01\"\n                    xml:space=\"preserve\"\n                    width=\"12px\"\n                    height=\"12px\"\n                >\n                    <g>\n                        <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" class=\"st0\" d=\"M16.35,0h90.19c8.99,0,16.35,7.36,16.35,16.35v75.32c0,8.99-7.36,16.35-16.35,16.35H16.35 C7.36,108.01,0,100.66,0,91.67V16.35C0,7.36,7.36,0,16.35,0L16.35,0z M64.64,77.54h49.62v21.2H64.64V77.54L64.64,77.54z M8.02,77.54h49.62v21.2H8.02V77.54L8.02,77.54z M8.02,21.13h49.62v21.2H8.02V21.13L8.02,21.13z M8.02,49.34h49.62v21.2H8.02V49.34 L8.02,49.34z M64.64,21.13h49.62v21.2H64.64V21.13L64.64,21.13z M64.64,49.34h49.62v21.2H64.64V49.34L64.64,49.34z\"/>\n                    </g>\n                </svg>`\n            ];\n        case LayerType.DATACSV:\n            return [\n                t('legend.layer.type.dataCsv'),\n                `<svg\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    viewBox=\"0 0 122.88 97.05\"\n                    height=\"12px\"\n                    width=\"12px\"\n                >\n                    <path d=\"M37.11,6.51A48.54,48.54,0,0,1,93,11.68l.27-.08c7-1.78,13.15-2.53,17.89-2.16,5.17.4,8.9,2.15,10.7,5.37,3.25,5.79-1.07,14.76-10.66,24.58-.58.59-1.19,1.19-1.81,1.8A48.53,48.53,0,0,1,30.12,85.64c-.85.22-1.69.42-2.51.61-13.36,3.07-23.25,2.07-26.5-3.72l0,0c-1.81-3.25-1.32-7.39,1.1-12.07,2.17-4.2,6-9,11.07-14l.21-.2A48.56,48.56,0,0,1,37.11,6.51Zm67.72,38.83A195.18,195.18,0,0,1,72.24,67.91l-.06,0A195.65,195.65,0,0,1,36,84a43.59,43.59,0,0,0,68.82-38.62Zm-80.59,26c3.39-.43,11.31-3.54,20.77-7.86,6.22-2.83,13-6.28,19.61-10s13-7.61,18.67-11.44c8.34-5.69,14.77-10.83,16.59-13.9q-.37-.7-.78-1.41A43.57,43.57,0,0,0,23.64,70.31l.6,1Z\"/></svg>`\n            ];\n        case LayerType.DATAJSON:\n            return [\n                t('legend.layer.type.dataJson'),\n                `<svg\n                    version=\"1.1\"\n                    id=\"Layer_1\"\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n                    x=\"0px\"\n                    y=\"0px\"\n                    viewBox=\"0 0 115.16 122.88\"\n                    style=\"enable-background:new 0 0 115.16 122.88\"\n                    xml:space=\"preserve\"\n                    width=\"12px\"\n                    height=\"12px\"\n                >\n                    <g>\n                        <path d=\"M0,69.1V53.79c4.65-0.04,8.13-1.42,10.49-4.12C12.82,46.96,14,40.87,14,31.41c0-7.22,0.26-12.56,0.81-16.03 c0.52-3.47,1.81-6.39,3.86-8.73c2.05-2.35,4.69-4.03,7.92-5.08C29.81,0.52,34.4,0,40.33,0h3.38v15.31c-6.2,0-9.9,0.63-11.12,1.92 c-1.22,1.27-1.88,3.77-1.96,7.48c-0.26,10.21-0.59,16.86-0.98,19.93c-0.41,3.05-1.35,5.98-2.81,8.77 c-1.46,2.79-4.19,5.47-8.18,8.03c3.8,2.31,6.54,5.06,8.24,8.24c1.72,3.21,2.75,7.81,3.03,13.83l0.96,18.63 c0.39,1.79,1.31,3.14,2.77,4.06c1.46,0.92,4.82,1.37,10.06,1.37v15.31h-3.34c-6.83,0-12.08-0.78-15.81-2.33 c-3.71-1.55-6.39-4.1-8.07-7.63c-1.66-3.55-2.49-9.27-2.49-17.14c0-8.7-0.31-14.26-0.89-16.71c-0.59-2.42-1.74-4.65-3.45-6.67 C7.94,70.36,4.73,69.27,0,69.1L0,69.1z M115.16,69.1c-4.65,0.04-8.14,1.42-10.49,4.17c-2.33,2.73-3.51,8.77-3.51,18.15 c0,7.26-0.26,12.61-0.76,16.1c-0.52,3.47-1.79,6.39-3.84,8.72c-2.05,2.36-4.71,4.03-7.94,5.08c-3.25,1.05-7.83,1.57-13.76,1.57 h-3.4v-15.31c5.95,0,9.6-0.61,10.93-1.85c1.35-1.24,2.07-3.75,2.16-7.55c0.26-10.93,0.65-17.93,1.18-21.03 c0.55-3.1,1.59-5.98,3.21-8.66c1.59-2.7,4.12-5.04,7.57-7.05c-3.64-2.38-6.19-4.73-7.63-7.02c-1.44-2.31-2.42-4.8-2.92-7.5 c-0.5-2.7-0.89-7.74-1.16-15.09c-0.24-7.35-0.55-11.56-0.9-12.61c-0.33-1.07-1.16-1.98-2.46-2.75c-1.31-0.76-4.62-1.16-9.97-1.16V0 h3.38c6.83,0,12.08,0.79,15.79,2.33c3.71,1.55,6.39,4.1,8.05,7.63c1.66,3.56,2.49,9.27,2.49,17.14c0,9.05,0.33,14.74,0.98,17.08 c0.68,2.36,1.83,4.49,3.53,6.43c1.68,1.94,4.84,2.99,9.49,3.16V69.1L115.16,69.1z\"/>\n                    </g>\n                </svg>`\n            ];\n        case LayerType.SUBLAYER:\n            return [\n                t('legend.layer.type.sublayer'),\n                `<svg\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    viewBox=\"0 0 122.88 112.99\"\n                    width=\"12px\"\n                    height=\"12px\"\n                >\n                    <path d=\"M120.62,39.52,63.1,68.12a3.75,3.75,0,0,1-3.33,0L2.1,39.45a3.78,3.78,0,0,1-.18-6.67L59.59.48a3.78,3.78,0,0,1,3.73,0L121,32.78a3.77,3.77,0,0,1-.33,6.74Zm-9.77,40.93a3.76,3.76,0,0,1,3.6-6.61l6.41,3.38a3.77,3.77,0,0,1,1.58,5.09A3.82,3.82,0,0,1,120.7,84L63.1,112.6a3.75,3.75,0,0,1-3.33,0L2.1,83.93a3.77,3.77,0,0,1-1.71-5A3.69,3.69,0,0,1,2,77.22l6-3.14a3.76,3.76,0,0,1,4,6.35L61.44,105l49.41-24.57ZM111,57.69a3.76,3.76,0,0,1,4.36-6l5.49,2.89a3.76,3.76,0,0,1-.16,6.74L63.1,89.92a3.75,3.75,0,0,1-3.33,0L2.1,61.25a3.78,3.78,0,0,1-1.71-5A3.72,3.72,0,0,1,2,54.54L7.9,51.43A3.77,3.77,0,0,1,12,57.74l49.47,24.6L111,57.69ZM61.44,60.54,111,35.87,61.44,8.09,11.83,35.87,61.44,60.54Z\"/>\n                </svg>`\n            ];\n        default:\n            return [\n                t('legend.layer.type.unknown'),\n                `<svg\n                    xmlns=\"http://www.w3.org/2000/svg\"\n                    shape-rendering=\"geometricPrecision\"\n                    text-rendering=\"geometricPrecision\"\n                    image-rendering=\"optimizeQuality\"\n                    fill-rule=\"evenodd\"\n                    clip-rule=\"evenodd\"\n                    viewBox=\"0 0 512 512\"\n                    width=\"12px\"\n                    height=\"12px\"\n                >\n                    <path d=\"M256 0c70.69 0 134.7 28.66 181.02 74.98C483.34 121.31 512 185.31 512 256c0 70.69-28.66 134.7-74.98 181.02C390.7 483.34 326.69 512 256 512c-70.69 0-134.69-28.66-181.02-74.98C28.66 390.7 0 326.69 0 256c0-70.69 28.66-134.69 74.98-181.02C121.31 28.66 185.31 0 256 0zm-21.91 302.69v-2.07c.16-13.72 1.51-24.59 4.15-32.67 2.59-8.08 6.32-14.65 11.18-19.63 4.87-5.02 10.72-9.58 17.56-13.72 4.4-2.8 8.39-5.9 11.91-9.37 3.52-3.42 6.32-7.41 8.38-11.91 2.07-4.46 3.11-9.42 3.11-14.91 0-6.53-1.55-12.18-4.66-16.99-3.05-4.77-7.19-8.44-12.27-11.08-5.13-2.59-10.82-3.89-17.09-3.89-5.65 0-11.03 1.15-16.21 3.53-5.12 2.33-9.42 6-12.79 10.97-3.36 4.98-5.33 11.35-5.85 19.11h-33.56c.53-13.21 3.89-24.39 10.05-33.55 6.21-9.16 14.4-16.11 24.55-20.82 10.2-4.71 21.49-7.04 33.81-7.04 13.57 0 25.38 2.48 35.52 7.56 10.15 5.02 18.08 12.06 23.72 21.08 5.59 9 8.44 19.47 8.44 31.48 0 8.23-1.29 15.64-3.88 22.21-2.59 6.58-6.22 12.48-10.98 17.61-4.77 5.18-10.41 9.73-17.03 13.67-6.27 3.94-11.35 7.97-15.18 12.17-3.88 4.19-6.68 9.17-8.44 14.86-1.76 5.74-2.75 12.84-2.9 21.33v2.07h-31.54zm16.68 70.67c-6.06 0-11.24-2.18-15.59-6.48-4.34-4.29-6.47-9.53-6.47-15.63 0-6.01 2.12-11.19 6.47-15.49 4.35-4.3 9.53-6.47 15.59-6.47 5.95 0 11.12 2.19 15.48 6.47 4.39 4.31 6.58 9.48 6.58 15.49 0 4.04-1.05 7.76-3.06 11.08-2.02 3.35-4.66 6.07-7.97 8.03-3.31 1.96-6.99 3-11.03 3z\"/>\n                </svg>`\n            ];\n    }\n});\n</script>\n\n<style lang=\"scss\" scoped></style>\n","<template>\n    <div :key=\"`${legendItem.uid}`\" v-if=\"!legendItem.hidden\" ref=\"el\">\n        <div class=\"relative\">\n            <div\n                class=\"flex items-center hover:bg-gray-200 default-focus-style !p-5\"\n                :class=\"[\n                    legendItem.type === LegendType.Item\n                        ? 'loaded-item'\n                        : legendItem.type === LegendType.Error\n                          ? 'non-loaded-item bg-red-200'\n                          : 'non-loaded-item',\n                    (isGroup && controlAvailable(LegendControl.Expand)) ||\n                    (!isGroup &&\n                        legendItem instanceof LayerItem &&\n                        controlAvailable(LayerControl.Datatable) &&\n                        getDatagridExists() &&\n                        legendItem.type === LegendType.Item)\n                        ? 'cursor-pointer'\n                        : 'cursor-default',\n                    allowMultilineItems ? 'multilined' : 'singlelined'\n                ]\"\n                @mouseover.stop=\"hover($event.currentTarget!)\"\n                @mouseout=\"\n                    //@ts-expect-error TODO: explain why this is needed or remove\n                    mobileMode ? null : $event.currentTarget?._tippy?.hide(), (hovered = false)\n                \"\n                @click=\"\n                    () => {\n                        if (\n                            !isGroup &&\n                            legendItem instanceof LayerItem &&\n                            controlAvailable(LayerControl.Datatable) &&\n                            getDatagridExists() &&\n                            legendItem.type === LegendType.Item\n                        ) {\n                            toggleGrid();\n                        } else if (isGroup) {\n                            toggleExpand();\n                        }\n                    }\n                \"\n                v-focus-item=\"'show-truncate'\"\n                :content=\"\n                    isGroup && controlAvailable(LegendControl.Expand)\n                        ? t(legendItem.expanded ? 'legend.group.collapse' : 'legend.group.expand')\n                        : legendItem instanceof LayerItem &&\n                            legendItem.type === LegendType.Item &&\n                            controlAvailable(LayerControl.Datatable) &&\n                            getDatagridExists()\n                          ? t('legend.layer.data')\n                          : ''\n                \"\n                v-tippy=\"{\n                    placement: 'bottom-start',\n                    trigger: 'manual focus',\n                    aria: 'describedby'\n                }\"\n                truncate-trigger\n                ref=\"legendFocusItem\"\n            >\n                <!-- smiley face. very important that we migrate this -->\n                <div class=\"flex p-5 mr-[13px]\" v-if=\"legendItem.type !== LegendType.Item\">\n                    <svg\n                        v-if=\"legendItem.type === LegendType.Placeholder\"\n                        xmlns=\"http://www.w3.org/2000/svg\"\n                        viewBox=\"0 0 24 24\"\n                        fill=\"black\"\n                        width=\"24px\"\n                        height=\"24px\"\n                    >\n                        <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n                        <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n                        <circle cx=\"15.5\" cy=\"9.5\" r=\"1.5\" />\n                        <circle cx=\"8.5\" cy=\"9.5\" r=\"1.5\" />\n                        <circle cx=\"15.5\" cy=\"9.5\" r=\"1.5\" />\n                        <circle cx=\"8.5\" cy=\"9.5\" r=\"1.5\" />\n                        <path\n                            d=\"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm0-2.5c2.33 0 4.32-1.45 5.12-3.5h-1.67c-.69 1.19-1.97 2-3.45 2s-2.75-.81-3.45-2H6.88c.8 2.05 2.79 3.5 5.12 3.5z\"\n                        />\n                    </svg>\n                    <!-- sad face for layer error -->\n                    <svg\n                        v-else\n                        xmlns=\"http://www.w3.org/2000/svg\"\n                        viewBox=\"0 0 24 24\"\n                        fill=\"black\"\n                        width=\"24px\"\n                        height=\"24px\"\n                    >\n                        <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n                        <path d=\"M0 0h24v24H0V0z\" fill=\"none\" />\n                        <circle cx=\"15.5\" cy=\"9.5\" r=\"1.5\" />\n                        <circle cx=\"8.5\" cy=\"9.5\" r=\"1.5\" />\n                        <circle cx=\"15.5\" cy=\"9.5\" r=\"1.5\" />\n                        <circle cx=\"8.5\" cy=\"9.5\" r=\"1.5\" />\n                        <path\n                            d=\"M 20,12C 20,7.6 16.4,4 12,4C 7.6,4 4,7.6 4,12C 4,16.4 7.6,20 12,20C 16.4,20 20,16.4 20,12 Z M 22,12C 22,17.5 17.5,22 12,22C 6.5,22 2,17.5 2,12C 2,6.5 6.5,2.00001 12,2.00001C 17.5,2.00001 22,6.5 22,12 Z M 15.5,8C 16.3,8 17,8.7 17,9.5C 17,10.3 16.3,11 15.5,11C 14.7,11 14,10.3 14,9.5C 14,8.7 14.7,8 15.5,8 Z M 10,9.5C 10,10.3 9.3,11 8.5,11C 7.7,11 7,10.3 7,9.5C 7,8.7 7.7,8 8.5,8C 9.3,8 10,8.7 10,9.5 Z M 12,14C 13.7524,14 15.2943,14.7212 16.1871,15.8129L 14.7697,17.2302C 14.3175,16.5078 13.2477,16 12,16C 10.7523,16 9.68254,16.5078 9.23024,17.2302L 7.81291,15.8129C 8.7057,14.7212 10.2476,14 12,14 Z\"\n                        ></path>\n                    </svg>\n                </div>\n\n                <!-- symbology stack toggle-->\n                <div\n                    class=\"relative w-32 h-32 mr-15\"\n                    v-if=\"\n                        legendItem.type === LegendType.Item &&\n                        legendItem instanceof LayerItem &&\n                        legendItem.layer.legend.length > 0\n                    \"\n                    @mouseover.stop\n                >\n                    <button\n                        type=\"button\"\n                        @click.stop=\"toggleSymbology\"\n                        :class=\"[controlAvailable(LayerControl.Symbology) ? 'cursor-pointer' : 'cursor-default']\"\n                        :disabled=\"!controlAvailable(LayerControl.Symbology)\"\n                        :content=\"\n                            legendItem instanceof LayerItem && legendItem.symbologyExpanded\n                                ? t('legend.symbology.hide')\n                                : t('legend.symbology.expand')\n                        \"\n                        :aria-label=\"\n                            legendItem instanceof LayerItem && legendItem.symbologyExpanded\n                                ? t('legend.symbology.hide')\n                                : t('legend.symbology.expand')\n                        \"\n                        v-tippy=\"{\n                            placement: 'bottom-start'\n                        }\"\n                    >\n                        <symbology-stack\n                            v-if=\"!legendItem.coverIcon\"\n                            :class=\"{\n                                'pointer-events-none': !controlAvailable(LayerControl.Symbology)\n                            }\"\n                            class=\"w-32 h-32\"\n                            :visible=\"legendItem instanceof LayerItem && legendItem.symbologyExpanded\"\n                            :legendItem=\"legendItem\"\n                        />\n                        <img\n                            v-else\n                            :class=\"{\n                                'pointer-events-none': !controlAvailable(LayerControl.Symbology)\n                            }\"\n                            class=\"w-32 h-32 hover:scale-105\"\n                            :src=\"legendItem.coverIcon\"\n                            alt=\"Cover icon not found :(\"\n                        />\n                    </button>\n                </div>\n\n                <!-- dropdown icon -->\n                <div\n                    v-if=\"isGroup && controlAvailable(LegendControl.Expand)\"\n                    class=\"expand-toggle p-8 pointer-events-none\"\n                    :class=\"{ 'rotate-180': legendItem.expanded }\"\n                >\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"18\" viewBox=\"0 0 24 24\" width=\"18\">\n                        <path d=\"M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z\" />\n                    </svg>\n                </div>\n\n                <!-- Name and mini-icons -->\n                <div\n                    v-if=\"legendItem instanceof LayerItem && allowMultilineItems\"\n                    class=\"flex flex-1 flex-col p-5\"\n                    :class=\"`line-clamp-${maxLines}`\"\n                    v-truncate=\"{\n                        externalTrigger: true,\n                        noTruncateClass: true\n                    }\"\n                >\n                    <!-- name or info section-->\n                    <div class=\"pointer-events-none\">\n                        <div\n                            class=\"flex-auto pointer-events-none p-5 truncate\"\n                            v-truncate=\"{\n                                externalTrigger: true,\n                                noTruncateClass: true\n                            }\"\n                        >\n                            <span class=\"h-auto break-words text-ellipsis\">{{\n                                legendItem.name ??\n                                (!legendItem?.layer?.name ? legendItem.layerId : legendItem.layer?.name)\n                            }}</span>\n                        </div>\n                    </div>\n                    <!-- Mini-icons -->\n                    <div\n                        v-if=\"legendItem.type !== LegendType.Placeholder\"\n                        class=\"ml-5 flex-none text-[11px] flex flex-row gap-2 mt-[-5px] flex-wrap w-fit\"\n                        v-focus-list=\"'horizontal'\"\n                        @mouseover.stop\n                    >\n                        <LayerTypeIcon\n                            v-focus-item\n                            :layerType=\"legendItem.layer?.layerType\"\n                            :featureCount=\"legendItem.layer?.featureCount\"\n                            @keypress.stop\n                            @click.stop\n                        />\n                        <!-- Datatable availability -->\n                        <!-- Clicking this icon will open the datatable, unlike the others -->\n                        <MiniIcon\n                            v-focus-item\n                            label=\"\"\n                            content=\"Datatable available (click to view)\"\n                            v-if=\"\n                                legendItem instanceof LayerItem &&\n                                controlAvailable(LayerControl.Datatable) &&\n                                getDatagridExists() &&\n                                legendItem.type === LegendType.Item\n                            \"\n                        >\n                            <svg\n                                class=\"fill-gray-800\"\n                                version=\"1.1\"\n                                id=\"Layer_1\"\n                                xmlns=\"http://www.w3.org/2000/svg\"\n                                xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n                                x=\"0px\"\n                                y=\"0px\"\n                                viewBox=\"0 0 122.88 108.01\"\n                                height=\"13px\"\n                                width=\"13px\"\n                                style=\"enable-background: new 0 0 122.88 108.01; fill: currentColor\"\n                                xml:space=\"preserve\"\n                            >\n                                <g>\n                                    <path\n                                        class=\"st0\"\n                                        fill-rule=\"evenodd\"\n                                        clip-rule=\"evenodd\"\n                                        d=\"M16.35,0h90.19c8.99,0,16.35,7.36,16.35,16.35v75.32c0,8.99-7.36,16.35-16.35,16.35H16.35 C7.36,108.01,0,100.66,0,91.67V16.35C0,7.36,7.36,0,16.35,0L16.35,0z M64.64,77.54h49.62v21.2H64.64V77.54L64.64,77.54z M8.02,77.54h49.62v21.2H8.02V77.54L8.02,77.54z M8.02,21.13h49.62v21.2H8.02V21.13L8.02,21.13z M8.02,49.34h49.62v21.2H8.02V49.34 L8.02,49.34z M64.64,21.13h49.62v21.2H64.64V21.13L64.64,21.13z M64.64,49.34h49.62v21.2H64.64V49.34L64.64,49.34z\"\n                                    />\n                                </g>\n                            </svg>\n                        </MiniIcon>\n                        <!-- Identify availability -->\n                        <!-- Show 'not available' when identify disabled, hide icon altogether if layer disabled -->\n                        <MiniIcon\n                            v-focus-item\n                            v-if=\"legendItem._visibility\"\n                            label=\"\"\n                            :content=\"\n                                legendItem.layer?.canIdentify()\n                                    ? 'Identify available (click map)'\n                                    : 'Identify disabled or unavailable'\n                            \"\n                            @keypress.stop\n                            @click.stop\n                        >\n                            <svg\n                                :class=\"[legendItem.layer?.canIdentify() ? 'fill-current' : 'fill-red-500']\"\n                                version=\"1.1\"\n                                id=\"Layer_1\"\n                                xmlns=\"http://www.w3.org/2000/svg\"\n                                xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n                                x=\"0px\"\n                                y=\"0px\"\n                                width=\"12px\"\n                                height=\"12px\"\n                                viewBox=\"0 0 122.879 119.799\"\n                                enable-background=\"new 0 0 122.879 119.799\"\n                                xml:space=\"preserve\"\n                                fill=\"currentColor\"\n                            >\n                                <g>\n                                    <path\n                                        d=\"M49.988,0h0.016v0.007C63.803,0.011,76.298,5.608,85.34,14.652c9.027,9.031,14.619,21.515,14.628,35.303h0.007v0.033v0.04 h-0.007c-0.005,5.557-0.917,10.905-2.594,15.892c-0.281,0.837-0.575,1.641-0.877,2.409v0.007c-1.446,3.66-3.315,7.12-5.547,10.307 l29.082,26.139l0.018,0.016l0.157,0.146l0.011,0.011c1.642,1.563,2.536,3.656,2.649,5.78c0.11,2.1-0.543,4.248-1.979,5.971 l-0.011,0.016l-0.175,0.203l-0.035,0.035l-0.146,0.16l-0.016,0.021c-1.565,1.642-3.654,2.534-5.78,2.646 c-2.097,0.111-4.247-0.54-5.971-1.978l-0.015-0.011l-0.204-0.175l-0.029-0.024L78.761,90.865c-0.88,0.62-1.778,1.209-2.687,1.765 c-1.233,0.755-2.51,1.466-3.813,2.115c-6.699,3.342-14.269,5.222-22.272,5.222v0.007h-0.016v-0.007 c-13.799-0.004-26.296-5.601-35.338-14.645C5.605,76.291,0.016,63.805,0.007,50.021H0v-0.033v-0.016h0.007 c0.004-13.799,5.601-26.296,14.645-35.338C23.683,5.608,36.167,0.016,49.955,0.007V0H49.988L49.988,0z M50.004,11.21v0.007h-0.016 h-0.033V11.21c-10.686,0.007-20.372,4.35-27.384,11.359C15.56,29.578,11.213,39.274,11.21,49.973h0.007v0.016v0.033H11.21 c0.007,10.686,4.347,20.367,11.359,27.381c7.009,7.012,16.705,11.359,27.403,11.361v-0.007h0.016h0.033v0.007 c10.686-0.007,20.368-4.348,27.382-11.359c7.011-7.009,11.358-16.702,11.36-27.4h-0.006v-0.016v-0.033h0.006 c-0.006-10.686-4.35-20.372-11.358-27.384C70.396,15.56,60.703,11.213,50.004,11.21L50.004,11.21z\"\n                                    />\n                                </g>\n                            </svg>\n\n                            <svg\n                                v-if=\"!legendItem.layer?.canIdentify()\"\n                                version=\"1.1\"\n                                id=\"Layer_1\"\n                                xmlns=\"http://www.w3.org/2000/svg\"\n                                xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n                                x=\"0px\"\n                                y=\"0px\"\n                                width=\"12px\"\n                                height=\"12px\"\n                                viewBox=\"0 0 122.879 122.879\"\n                                enable-background=\"new 0 0 122.879 122.879\"\n                                xml:space=\"preserve\"\n                                fill=\"currentColor\"\n                            >\n                                <g>\n                                    <path\n                                        fill=\"#FF4141\"\n                                        d=\"M61.44,0c16.96,0,32.328,6.882,43.453,17.986c11.104,11.125,17.986,26.494,17.986,43.453 c0,16.961-6.883,32.328-17.986,43.453C93.769,115.998,78.4,122.879,61.44,122.879c-16.96,0-32.329-6.881-43.454-17.986 C6.882,93.768,0,78.4,0,61.439C0,44.48,6.882,29.111,17.986,17.986C29.112,6.882,44.48,0,61.44,0L61.44,0z M73.452,39.152 c2.75-2.792,7.221-2.805,9.986-0.026c2.764,2.776,2.775,7.292,0.027,10.083L71.4,61.445l12.077,12.25 c2.728,2.77,2.689,7.256-0.081,10.021c-2.772,2.766-7.229,2.758-9.954-0.012L61.445,71.541L49.428,83.729 c-2.75,2.793-7.22,2.805-9.985,0.025c-2.763-2.775-2.776-7.291-0.026-10.082L51.48,61.435l-12.078-12.25 c-2.726-2.769-2.689-7.256,0.082-10.022c2.772-2.765,7.229-2.758,9.954,0.013L61.435,51.34L73.452,39.152L73.452,39.152z M96.899,25.98C87.826,16.907,75.29,11.296,61.44,11.296c-13.851,0-26.387,5.611-35.46,14.685 c-9.073,9.073-14.684,21.609-14.684,35.459s5.611,26.387,14.684,35.459c9.073,9.074,21.609,14.686,35.46,14.686 c13.85,0,26.386-5.611,35.459-14.686c9.073-9.072,14.684-21.609,14.684-35.459S105.973,35.054,96.899,25.98L96.899,25.98z\"\n                                    />\n                                </g>\n                            </svg>\n                        </MiniIcon>\n                        <!-- Icon for user-added layers -->\n                        <MiniIcon\n                            v-focus-item\n                            label=\"User\"\n                            content=\"User-added layer (will not save across sessions)\"\n                            v-if=\"legendItem.layer?.userAdded\"\n                            @keypress.stop\n                            @click.stop\n                        >\n                            <svg\n                                version=\"1.1\"\n                                id=\"Layer_1\"\n                                xmlns=\"http://www.w3.org/2000/svg\"\n                                xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n                                x=\"0px\"\n                                y=\"0px\"\n                                height=\"12px\"\n                                width=\"12px\"\n                                class=\"fill-green-600\"\n                                viewBox=\"0 0 122.88 121.42\"\n                                style=\"enable-background: new 0 0 122.88 121.42\"\n                                xml:space=\"preserve\"\n                            >\n                                <g>\n                                    <path\n                                        fill-rule=\"evenodd\"\n                                        clip-rule=\"evenodd\"\n                                        class=\"st0\"\n                                        d=\"M0,121.42l0-19.63c10.5-4.67,42.65-13.56,44.16-26.41c0.34-2.9-6.5-13.96-8.07-19.26 c-3.36-5.35-4.56-13.85-0.89-19.5c1.46-2.25,0.84-10.44,0.84-13.53c0-30.77,53.92-30.78,53.92,0c0,3.89-0.9,11.04,1.22,14.1 c3.54,5.12,1.71,14.19-1.27,18.93c-1.91,5.57-9.18,16.11-8.56,19.26c2.31,11.74,32.13,19.63,41.52,23.8l0,22.23L0,121.42L0,121.42z\"\n                                    />\n                                </g>\n                            </svg>\n                            <svg\n                                xmlns=\"http://www.w3.org/2000/svg\"\n                                shape-rendering=\"geometricPrecision\"\n                                text-rendering=\"geometricPrecision\"\n                                image-rendering=\"optimizeQuality\"\n                                fill-rule=\"evenodd\"\n                                clip-rule=\"evenodd\"\n                                viewBox=\"0 0 512 511.99\"\n                                width=\"12px\"\n                                height=\"12px\"\n                                class=\"fill-green-600\"\n                            >\n                                <path\n                                    fill=\"#00AB42\"\n                                    fill-rule=\"nonzero\"\n                                    d=\"M256 0c70.68 0 134.68 28.67 181.01 74.99 46.32 46.32 74.99 110.32 74.99 181S483.33 390.68 437.01 437c-46.33 46.33-110.33 74.99-181.01 74.99-70.68 0-134.68-28.66-181.01-74.99C28.67 390.68 0 326.67 0 255.99c0-70.68 28.67-134.68 74.99-181C121.32 28.67 185.32 0 256 0z\"\n                                />\n                                <path\n                                    fill=\"#fff\"\n                                    d=\"M234.68 130.59h42.64c10.11 0 18.38 8.29 18.38 18.39v67.32h67.32c10.11 0 18.38 8.33 18.38 18.38v42.63c0 10.09-8.3 18.38-18.38 18.38H295.7v67.32c0 10.1-8.28 18.39-18.38 18.39h-42.64c-10.1 0-18.38-8.27-18.38-18.39v-67.32h-67.32c-10.08 0-18.38-8.26-18.38-18.38v-42.63c0-10.12 8.27-18.38 18.38-18.38h67.32v-67.32c0-10.12 8.27-18.39 18.38-18.39z\"\n                                />\n                            </svg>\n                        </MiniIcon>\n                    </div>\n                </div>\n                <!-- Version if multiline legend items is turned off -->\n                <div\n                    v-else-if=\"legendItem instanceof LayerItem\"\n                    class=\"flex-1 pointer-events-none p-5\"\n                    v-truncate=\"{ externalTrigger: true }\"\n                >\n                    <span>{{\n                        legendItem.name ??\n                        (!legendItem.layer || legendItem?.layer?.name === ''\n                            ? legendItem.layerId\n                            : legendItem.layer?.name)\n                    }}</span>\n                </div>\n                <div v-else-if=\"legendItem instanceof SectionItem\" class=\"flex-1\">\n                    <h3 class=\"text-lg font-bold\" v-if=\"legendItem.infoType === InfoType.Title && legendItem.content\">\n                        {{ legendItem.content }}\n                    </h3>\n                    <h3 v-else-if=\"legendItem.infoType === InfoType.Title\">\n                        {{ legendItem.name }}\n                    </h3>\n                    <p v-else-if=\"legendItem.infoType === InfoType.Text\">\n                        {{ legendItem.content }}\n                    </p>\n                    <img\n                        v-else-if=\"legendItem.infoType === InfoType.Image\"\n                        :src=\"legendItem.content\"\n                        alt=\"InfoType image not found :(\"\n                    />\n                    <div\n                        v-else-if=\"legendItem.infoType === InfoType.Markdown\"\n                        class=\"ramp-markdown\"\n                        v-html=\"markdownToHtml(legendItem.content)\"\n                    ></div>\n                    <component v-else :is=\"`${legendItem.uid}-info-section`\"></component>\n                </div>\n\n                <!-- reload for error'd items -->\n                <div class=\"relative\" v-if=\"legendItem.type === LegendType.Error && reloadableLayer\">\n                    <button\n                        type=\"button\"\n                        class=\"text-gray-500 hover:text-black\"\n                        :content=\"t('legend.layer.controls.reload')\"\n                        v-tippy=\"{\n                            placement: 'top-start'\n                        }\"\n                        @mouseover.stop\n                        @click.stop=\"reloadLayer\"\n                        :aria-label=\"t('legend.layer.controls.reload')\"\n                    >\n                        <div class=\"flex p-8\">\n                            <svg class=\"inline-block fill-current w-18 h-18\" viewBox=\"0 0 24 24\">\n                                <path\n                                    d=\"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z\"\n                                ></path>\n                            </svg>\n                        </div>\n                    </button>\n                </div>\n\n                <!-- options dropdown menu -->\n                <legend-options\n                    v-if=\"\n                        (legendItem.type === LegendType.Item ||\n                            (legendItem.type === LegendType.Placeholder && allowMultilineItems)) &&\n                        legendItem instanceof LayerItem\n                    \"\n                    :class=\"{\n                        invisible: legendItem.type === LegendType.Placeholder\n                    }\"\n                    :legendItem=\"legendItem\"\n                    @focus-item=\"() => $emit('focusItem', legendFocusItem as HTMLElement)\"\n                />\n\n                <!-- Button only appears for loading or errored LayerItems -->\n                <!-- Morphs depending on state. Cancel for loading, Remove for Errored -->\n                <div v-if=\"legendItem.type !== LegendType.Item && legendItem instanceof LayerItem\" class=\"relative\">\n                    <button\n                        type=\"button\"\n                        class=\"text-gray-500 hover:text-black\"\n                        :content=\"\n                            legendItem.type === LegendType.Error\n                                ? t('legend.layer.controls.remove')\n                                : t('legend.layer.controls.cancel')\n                        \"\n                        v-tippy=\"{\n                            placement: 'top-start'\n                        }\"\n                        @mouseover.stop\n                        @click.stop=\"cancelOrRemoveLayer\"\n                        :aria-label=\"\n                            legendItem.type === LegendType.Error\n                                ? t('legend.layer.controls.remove')\n                                : t('legend.layer.controls.cancel')\n                        \"\n                    >\n                        <div class=\"flex p-5\">\n                            <svg\n                                v-if=\"legendItem.type === LegendType.Placeholder\"\n                                class=\"fill-current w-18 h-18\"\n                                xmlns=\"http://www.w3.org/2000/svg\"\n                                viewBox=\"0 0 352 512\"\n                            >\n                                <path\n                                    d=\"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z\"\n                                />\n                            </svg>\n                            <svg v-else class=\"inline-block fill-current w-18 h-18 mr-1\" viewBox=\"0 1 23 22\">\n                                <path\n                                    d=\"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z\"\n                                ></path>\n                            </svg>\n                        </div>\n                    </button>\n                </div>\n\n                <!-- offscale icon -->\n                <div\n                    class=\"relative p-4 cursor-default\"\n                    :content=\"t('legend.layer.offscale')\"\n                    v-tippy=\"{\n                        placement: 'top-start'\n                    }\"\n                    @mouseover.stop\n                    @click.stop\n                    v-if=\"\n                        legendItem.type === LegendType.Item &&\n                        legendItem instanceof LayerItem &&\n                        legendItem.layerOffscale\n                    \"\n                    focus-icon\n                >\n                    <svg class=\"inline-block fill-gray-400 w-18 h-18\" viewBox=\"0 0 24 24\">\n                        <path\n                            d=\"M19.81 14.99l1.19-.92-1.43-1.43-1.19.92 1.43 1.43zm-.45-4.72L21 9l-9-7-2.91 2.27 7.87 7.88 2.4-1.88zM3.27 1L2 2.27l4.22 4.22L3 9l1.63 1.27L12 16l2.1-1.63 1.43 1.43L12 18.54l-7.37-5.73L3 14.07l9 7 4.95-3.85L20.73 21 22 19.73 3.27 1z\"\n                        ></path>\n                    </svg>\n                </div>\n\n                <!-- data only icon -->\n                <div\n                    class=\"relative p-4 cursor-default\"\n                    :content=\"t('legend.layer.data.only')\"\n                    v-tippy=\"{\n                        placement: 'top-end'\n                    }\"\n                    @mouseover.stop\n                    @click.stop\n                    v-if=\"\n                        legendItem.type === LegendType.Item &&\n                        legendItem instanceof LayerItem &&\n                        !legendItem.layer?.mapLayer\n                    \"\n                    focus-icon\n                >\n                    <svg\n                        xmlns=\"http://www.w3.org/2000/svg\"\n                        height=\"18\"\n                        viewBox=\"0 -960 960 960\"\n                        width=\"18\"\n                        class=\"inline-block fill-gray-400\"\n                    >\n                        <path\n                            d=\"m776.109-63.565-73.435-69.196q-51.302 32.573-106.091 59.145-54.788 26.572-116.255 26.572-88.94 0-167.803-33.893-78.862-33.894-138.052-93.239-59.19-59.346-93.19-138.205-34-78.86-34-167.619 0-64.607 19.12-125.521Q85.521-666.435 120-719.674l-50.848-50.848 68.761-68.761L844.87-132.326l-68.761 68.76Zm-345.392-92.653v-72.5l-52.25-52.086v-50.009l-219.01-218.752q-3 17.015-5 34.031-2 17.015-2 35.136 0 124.449 78.826 214.674 78.826 90.224 199.434 109.506Zm410.392-85.412-76.739-77.74q21.288-37.275 32.35-77.847 11.062-40.572 11.062-84.059 0-95.003-56.304-169.853-56.304-74.849-145.391-108.893v.522l-174.413 76.087v31.348L241.87-842.109q52.483-34.989 113.387-52.918 60.903-17.93 125.159-17.93 89.709 0 168.127 33.869 78.418 33.868 137.435 93.28 59.016 59.413 92.997 137.683 33.982 78.269 33.982 167.993 0 64.203-18.43 125.111-18.429 60.907-53.418 113.391Z\"\n                        />\n                    </svg>\n                </div>\n\n                <!-- zoom button for offscale layers -->\n                <div\n                    class=\"relative top-1\"\n                    v-if=\"\n                        legendItem.type === LegendType.Item &&\n                        legendItem instanceof LayerItem &&\n                        legendItem.layerOffscale\n                    \"\n                >\n                    <button\n                        type=\"button\"\n                        class=\"p-4\"\n                        :content=\"t('legend.layer.zoomToVisible')\"\n                        v-tippy=\"{\n                            placement: 'top-start'\n                        }\"\n                        @mouseover.stop\n                        @click.stop=\"(legendItem as LayerItem).layer.zoomToVisibleScale()\"\n                    >\n                        <svg\n                            class=\"m-auto\"\n                            xmlns=\"http://www.w3.org/2000/svg\"\n                            height=\"18\"\n                            viewBox=\"0 0 24 24\"\n                            width=\"18\"\n                        >\n                            <path\n                                d=\"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z\"\n                            ></path>\n                            <path d=\"M0 0h24v24H0V0z\" fill=\"none\"></path>\n                            <path d=\"M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z\"></path>\n                        </svg>\n                    </button>\n                </div>\n\n                <!-- visibility -->\n                <checkbox\n                    v-else-if=\"legendItem.type === LegendType.Item && controlAvailable(LegendControl.Visibility)\"\n                    :checked=\"legendItem.visibility\"\n                    :value=\"legendItem as LegendItem\"\n                    :isRadio=\"legendItem.parent && legendItem.parent.exclusive\"\n                    :legendItem=\"legendItem\"\n                    :disabled=\"\n                        legendItem instanceof LayerItem && !legendItem.layerControlAvailable(LayerControl.Visibility)\n                    \"\n                    :label=\"isGroup ? 'Group' : 'Layer'\"\n                />\n            </div>\n            <div\n                v-if=\"\n                    legendItem.type === LegendType.Placeholder ||\n                    (legendItem instanceof LayerItem && legendItem.layerRedrawing && legendItem.visibility)\n                \"\n                class=\"h-3 w-full absolute bottom-0\"\n            >\n                <div class=\"progress-line\"></div>\n            </div>\n        </div>\n        <!-- Symbology Stack Section -->\n        <div\n            v-if=\"legendItem instanceof LayerItem && legendItem.symbologyExpanded\"\n            v-focus-item\n            class=\"symbology-stack default-focus-style\"\n        >\n            <div v-if=\"symbologyStack.length > 0\">\n                <!-- display each symbol -->\n                <p v-if=\"legendItem instanceof LayerItem && legendItem.description\" class=\"m-5\">\n                    {{ legendItem.description }}\n                </p>\n                <div class=\"m-5\" v-for=\"item in symbologyStack\" :key=\"item.uid\">\n                    <!-- for WMS layers and image render styles -->\n                    <div\n                        v-if=\"\n                            (item.imgUrl && legendItem.symbologyRenderStyle === 'images') ||\n                            (!item.imgUrl && layerType === 'ogc-wms')\n                        \"\n                        class=\"items-center grid-cols-1\"\n                    >\n                        <div v-if=\"item.imgUrl\" class=\"symbologyIcon w-full p-5\">\n                            <img class=\"max-w-full\" :src=\"item.imgUrl\" />\n                        </div>\n                        <div\n                            v-else-if=\"item.imgHeight\"\n                            class=\"symbologyIcon w-full p-5\"\n                            v-html=\"getLegendGraphic(item)\"\n                        ></div>\n                        <div v-if=\"item.label\" class=\"flex-1 p-5 bg-black-75 text-white\" v-truncate>\n                            <span>{{ item.label }}</span>\n                            <checkbox\n                                v-if=\"\n                                    (!item.imgUrl && symbologyStack.length > 1) ||\n                                    (item.imgUrl && item.definitionClause)\n                                \"\n                                class=\"float-right\"\n                                :value=\"item\"\n                                :legendItem=\"legendItem\"\n                                :checked=\"item.visibility\"\n                                :disabled=\"!controlAvailable(LayerControl.Visibility)\"\n                                label=\"Symbol\"\n                            />\n                        </div>\n                    </div>\n                    <!-- for non-WMS layers -->\n                    <div v-else class=\"flex items-center\">\n                        <div v-if=\"item.imgUrl\" class=\"symbologyIcon\">\n                            <img class=\"w-32 h-32\" :src=\"item.imgUrl\" />\n                        </div>\n                        <div v-else-if=\"item.svgcode\" class=\"symbologyIcon\">\n                            <span v-html=\"item.svgcode\"></span>\n                        </div>\n                        <div class=\"flex-1 ml-15\" v-truncate>\n                            {{ item.label }}\n                        </div>\n                        <checkbox\n                            v-if=\"\n                                modifiableLayer &&\n                                legendItem.layer.supportsFeatures &&\n                                ((!item.imgUrl && symbologyStack.length > 1) || (item.imgUrl && item.definitionClause))\n                            \"\n                            :value=\"item\"\n                            :legendItem=\"legendItem\"\n                            :checked=\"item.visibility\"\n                            :disabled=\"!controlAvailable(LayerControl.Visibility)\"\n                            label=\"Symbol\"\n                        />\n                    </div>\n                </div>\n            </div>\n            <div v-if=\"!symbologyStackLoaded\">\n                <!-- display loading text if the stack hasn't loaded yet -->\n                <div class=\"flex p-5 ml-48\" v-truncate>\n                    <div class=\"relative animate-spin spinner h-20 w-20 mr-10 pt-2\" v-if=\"isAnimationEnabled\"></div>\n                    <div class=\"flex-1 text-gray-500\" v-truncate>\n                        <span>{{ t('legend.symbology.loading') }}</span>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <!-- Display children of the group -->\n        <div class=\"legend-group border-l-2 ml-4 pl-4\" v-if=\"legendItem.expanded\">\n            <item\n                v-for=\"item in legendItem.children\"\n                :legendItem=\"item\"\n                :key=\"item.uid\"\n                @focus-item=\"(focusItem: HTMLElement) => $emit('focusItem', focusItem)\"\n            />\n        </div>\n    </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { GlobalEvents, InstanceAPI } from '@/api';\nimport type { LegendSymbology, RampLayerConfig } from '@/geo/api';\nimport { InitiationState, LayerControl } from '@/geo/api';\nimport { useLayerStore } from '@/stores/layer';\nimport to from 'await-to-js';\nimport { marked } from 'marked';\nimport type { PropType } from 'vue';\nimport { computed, inject, ref, toRaw, useTemplateRef, watch } from 'vue';\nimport { LayerItem } from '../store/layer-item';\nimport { LegendControl, LegendType } from '../store/legend-item';\nimport { InfoType, SectionItem } from '../store/section-item';\nimport Checkbox from './checkbox.vue';\nimport LegendOptions from './legend-options.vue';\nimport { usePanelStore } from '@/stores/panel';\nimport { useI18n } from 'vue-i18n';\nimport { useLegendStore } from '../store';\n\n// eslint doesn't recognize <symbology-stack> usage\n// eslint-disable-next-line\nimport SymbologyStack from './symbology-stack.vue';\n\n// eslint-disable-next-line\nimport MiniIcon from './mini-icon.vue';\n// eslint-disable-next-line\nimport LayerTypeIcon from './layertype-icon.vue';\n\nimport type { LegendAPI } from '../api/legend';\nimport type { LegendItem } from '../store/legend-item';\n\nconst layerStore = useLayerStore();\nconst panelStore = usePanelStore();\nconst { t } = useI18n();\nconst iApi = inject('iApi') as InstanceAPI;\nconst el = ref();\n\nconst props = defineProps({\n    legendItem: {\n        type: Object as PropType<LegendItem | LayerItem | SectionItem>,\n        required: true\n    }\n});\n\nconst legendStore = useLegendStore();\nconst allowMultilineItems = legendStore.multilineItems;\nconst maxLines = (props.legendItem instanceof LayerItem && props.legendItem.maxLines) ?? legendStore.maxLines;\n\nconst mobileMode = ref(panelStore.mobileView);\nconst layerConfigs = computed(() => layerStore.layerConfigs);\nconst symbologyStack = ref<Array<LegendSymbology>>([]); // ref instead of reactive to maintain reactivity after promise\nconst symbologyStackLoaded = ref<boolean>(false);\nconst hovered = ref(false);\nconst legendFocusItem = useTemplateRef('legendFocusItem');\n\n/**\n * Get the type of layer\n */\nconst layerType = computed((): string | undefined => {\n    return props.legendItem instanceof LayerItem ? toRaw(props.legendItem!.layer)?.layerType : '';\n});\n\n/**\n * Determine if the layer is modifiable\n */\nconst modifiableLayer = computed((): boolean => {\n    return props.legendItem instanceof LayerItem && toRaw(props.legendItem!.layer)?.canModifyLayer;\n});\n\n/**\n * Determine if the layer is reloadable\n */\nconst reloadableLayer = computed((): boolean => {\n    if (props.legendItem instanceof LayerItem) {\n        const rawLayer = toRaw(props.legendItem.layer);\n        if (rawLayer) {\n            return rawLayer.canReload;\n        } else {\n            // funny logic: if layer doesn't exist, it hasn't been registered and\n            // linked yet. Main scenario is MIL children who don't get created\n            // until after parent loads.\n            // Non-reloadability is typically due to file stuff via wizard or\n            // using rawData + no caching config. Their RAMP layer will register\n            // prior to failpoints.\n            // So return true, else child-bound entries won't be able to reload\n            return true;\n        }\n    } else {\n        return false;\n    }\n});\n\n/**\n * Get animation enabled status\n */\nconst isAnimationEnabled = computed((): boolean => {\n    return iApi.animate;\n});\n\n/**\n * Get if this item is a group (has at least one child)\n */\nconst isGroup = computed((): boolean => {\n    return (\n        props.legendItem.children.length > 0 ||\n        // TODO: Determine why Vue reactivity isn't picking updates to the children property of the parent.\n        // isGroup is being called on the parent before the children are mapped in legend.ts. After they're mapped, isGroup isn't called again.\n        (props.legendItem instanceof LayerItem && toRaw(props.legendItem!.layer)?.sublayers.length > 0)\n    );\n});\n\n/**\n * Designate between layer controls and legend controls\n */\nconst controlAvailable = (control: LegendControl | LayerControl): boolean | undefined => {\n    if (control === LegendControl.Expand || control === LegendControl.Visibility)\n        return props.legendItem.controlAvailable(control as LegendControl);\n    else return (props.legendItem as LayerItem).layerControlAvailable(control as LayerControl);\n};\n\nconst markdownToHtml = (md: string) => {\n    return marked(md);\n};\n\nconst toggleExpand = () => {\n    if (props.legendItem.children.length === 0 || !controlAvailable(LegendControl.Expand)) {\n        return;\n    }\n    props.legendItem.toggleExpanded();\n    iApi.updateAlert(t(`legend.alert.group${props.legendItem.expanded ? 'Expanded' : 'Collapsed'}`));\n};\n/**\n * Display symbology stack for the layer.\n */\nconst toggleSymbology = (): void => {\n    if (controlAvailable(LayerControl.Symbology)) {\n        const expanded = (props.legendItem as LayerItem).toggleSymbology();\n        iApi.updateAlert(t(`legend.alert.symbology${expanded ? 'Expanded' : 'Collapsed'}`));\n    }\n};\n\n/**\n * Toggles data table panel to open/close for the LegendItem.\n */\nconst toggleGrid = (): void => {\n    if (controlAvailable(LayerControl.Datatable) && getDatagridExists()) {\n        iApi.event.emit(GlobalEvents.GRID_TOGGLE, (props.legendItem as LayerItem).layer);\n    }\n};\n\n/**\n * Returns a span containing the resized legend graphic.\n */\nconst getLegendGraphic = (item: any): string | undefined => {\n    const span = document.createElement('span');\n    span.innerHTML = item.svgcode;\n    const svg = span.firstElementChild;\n    // The legend graphic will display either in its original size, or resized to fit the width of the legend item.\n    svg?.classList.add('max-w-full');\n    svg?.classList.add('h-full');\n    svg?.setAttribute('height', item.imgHeight);\n    svg?.setAttribute('width', item.imgWidth);\n    return span.outerHTML;\n};\n\n/**\n * Indicates if the data grid fixture has been added\n */\nconst getDatagridExists = (): boolean => {\n    try {\n        return iApi.fixture.exists('grid');\n    } catch {\n        return false;\n    }\n};\n\n/**\n * Reloads a layer on the map.\n * Layer is in an error'd state for that UI to be available.\n */\nconst reloadLayer = () => {\n    props.legendItem.reload();\n    // want the animation to play for half a second because a reload can fail \"instantly\", making it look like nothing happened to the user\n    setTimeout(() => {\n        const layerItemProp = props.legendItem as LayerItem;\n        let recreateFromConfig = true;\n\n        if (layerItemProp.layer) {\n            // layer exists, reload it\n            toRaw(layerItemProp.layer).reload();\n            recreateFromConfig = false;\n        } else if (layerItemProp.isSublayer && layerItemProp.parentLayerId) {\n            // see if parent exists, if so, reload it.\n            const testParent = iApi.geo.layer.getLayer(layerItemProp.parentLayerId);\n            if (testParent) {\n                toRaw(testParent).reload();\n                recreateFromConfig = false;\n            }\n        }\n\n        if (recreateFromConfig) {\n            // were unable to find any layers. Attempt to re-create layer with layer config\n\n            const targetId = layerItemProp.isSublayer ? layerItemProp.parentLayerId : layerItemProp.layerId;\n\n            const layerConfig = layerConfigs.value.find(lc => lc.id === targetId);\n            if (layerConfig !== undefined) {\n                recreateLayer(layerConfig as RampLayerConfig);\n            }\n        }\n\n        // just to silence console about unhandled rejections.\n        props.legendItem.loadPromise.catch(() => {});\n    }, 400);\n};\n\n/**\n * Attempt to recreate and instantiate layer from config.\n * Used when an initial layer failed to attach itself to the legend item\n */\nconst recreateLayer = async (layerConfig: RampLayerConfig) => {\n    try {\n        // check if the layer exists in store.\n        // if so, attempt to reload.\n        const checkLayer = iApi.geo.layer.getLayer(layerConfig.id);\n        if (checkLayer) {\n            const [reloadErr] = await to(toRaw(checkLayer).reload());\n            if (reloadErr) {\n                throw new Error();\n            } else {\n                return checkLayer;\n            }\n        } else {\n            // try to re-create new layer based on layerConfig\n            // same code to how layers are initialized when layer config array changes, expose this as layer API method?\n\n            // TODO low priority investigation: now that layers get registered right away,\n            // can this ELSE block even get hit anymore? I think we'll always find checkLayer.\n            // if layer got removed, legend block should have vanished.\n            const layer = iApi.geo.layer.createLayer(layerConfig);\n\n            await iApi.geo.map.addLayer(layer).catch(() => {\n                throw new Error();\n            });\n\n            return layer;\n        }\n    } catch {\n        return;\n    }\n};\n\n/**\n * Dual use method, leveraged for layers not in a loaded, active state.\n * For a loading layer, will \"Cancel\" it. This puts it in the error state but keeps it registered.\n * For an errored layer, will \"Remove\" it. Layer deleted from legend, map, and unregistered.\n */\nconst cancelOrRemoveLayer = () => {\n    const layerItem: LayerItem = toRaw(props.legendItem as LayerItem); // so that typescript doesn't yell in the whole method\n    let safetyCount = 0;\n\n    if (layerItem.type === LegendType.Error) {\n        // layer in error state, remove layer permanently\n        // layer could appear later, so we need to keep checking if its there.\n        // It will typically be in the store (now happens soon as its added),\n        // but the ESRI layer may appear later if things get wacky.\n        // given we can also cancel prior to initiation finishing, we consider\n        // layers in that state.\n\n        props.legendItem.toggleHidden(true); // temporarily hide item until we can remove it\n\n        const removalWatcher = setInterval(() => {\n            // test: we can find the Ramp layer AND ...\n            //           the Esri layer exists OR layer is not on the path to have an Esri layer\n            //       OR if it's been 5 minutes, stop and try ur best (1200 * 250 === five mins)\n\n            const rampL = layerItem.layer;\n\n            if (\n                (rampL &&\n                    (rampL.layerExists ||\n                        rampL.initiationState === InitiationState.NEW ||\n                        rampL.initiationState === InitiationState.TERMINATING ||\n                        rampL.initiationState === InitiationState.TERMINATED)) ||\n                safetyCount > 1200\n            ) {\n                // stop the interval\n                clearInterval(removalWatcher);\n\n                if (rampL) {\n                    // remove from the map, which will de-register and remove anything from the map\n                    iApi.geo.map.removeLayer(rampL);\n                }\n\n                // remove layer config from store\n                layerStore.removeLayerConfig(layerItem.layerId);\n\n                // remove layer item from legend\n                iApi.fixture.get<LegendAPI>('legend')?.removeLayerItem(layerItem.layerId);\n            }\n\n            safetyCount++;\n        }, 250);\n    } else {\n        // layer in loading state, \"cancel\" layer\n        // this puts it in error state. user can then reload or remove\n\n        props.legendItem.error();\n\n        // if a sublayer or parent layer was cancelled, cancel the parent layer and all other sublayers.\n        // need to keep polling for the parent layer since some sublayers may not be in the config (stuff that came from a group)\n\n        // This should find stuff real quick now that layers are immediately registered. But keeping the watcher to handle\n        // any weird scenarios (e.g. RampMapAPI.addLayer had critical failure)\n        // The interval is at a faster rate to account for any rapid cancel & reload clicks. setInterval always waits the interval\n        // before first check.\n        const cancelWatcher = setInterval(() => {\n            const parentmostId = layerItem.parentLayerId || layerItem.layerId;\n            const parentLayer = iApi.geo.layer.getLayer(parentmostId);\n\n            if (parentLayer) {\n                clearInterval(cancelWatcher);\n\n                // cancel the ramp layer\n                parentLayer.cancelLoad();\n\n                // cancel any blocks tied to the layer or sublayers.\n\n                const affectedBlocks = iApi.fixture.get<LegendAPI>('legend')?.getLayerBoundItems(parentLayer) || [];\n\n                affectedBlocks.forEach(block => block.error());\n            }\n\n            if (safetyCount > 1200) {\n                // 1 minute\n                clearInterval(cancelWatcher);\n            }\n\n            safetyCount++;\n        }, 50);\n    }\n};\n\nconst loadSymbologyStack = () => {\n    // load the symbology only when the layer is loaded\n    props.legendItem.loadPromise\n        .then(() => {\n            symbologyStack.value = [];\n            // Wait for symbology to load\n            if (!(props.legendItem as LayerItem).layer) {\n                // This should never happen because the layer is loaded before the legend item component is mounted\n                console.warn('Attempted to mount legend item component with undefined layer');\n                return;\n            }\n            Promise.all(\n                toRaw((props.legendItem as LayerItem).symbologyStack.map((item: LegendSymbology) => item.drawPromise))\n            ).then(() => {\n                symbologyStack.value = (props.legendItem as LayerItem).symbologyStack;\n\n                // Mark the symbology stack as loaded.\n                symbologyStackLoaded.value = true;\n            });\n        })\n        .catch(() => {});\n};\n\n/**\n * Helper function needed to delay tooltips using the _tippy?.show() workaround\n */\nconst hover = (t: EventTarget) => {\n    hovered.value = true;\n    setTimeout(() => {\n        if (hovered.value) {\n            if (!mobileMode.value) {\n                //@ts-expect-error TODO: explain why this is needed or remove\n                t._tippy?.show();\n            }\n        }\n    }, 300);\n};\n\nif (props.legendItem instanceof LayerItem) {\n    loadSymbologyStack();\n    watch(\n        () => (props.legendItem as LayerItem).symbologyStack,\n        () => {\n            loadSymbologyStack();\n        }\n    );\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.legend-group {\n    transition: max-height 0.7s ease-in;\n}\n.expand-toggle {\n    transition: transform 0.3s cubic-bezier(0.35, 0, 0.25, 1);\n}\n.rotate-180 {\n    transform: rotate(-180deg);\n}\n\n@media (hover) {\n    .loaded-item.singlelined {\n        @apply min-h-[39px];\n        .options {\n            @apply hidden;\n        }\n    }\n    .loaded-item.multilined {\n        @apply min-h-[39px];\n        .options {\n            @apply block;\n        }\n    }\n    .loaded-item:hover {\n        .options {\n            @apply block;\n        }\n    }\n}\n.loaded-item:focus-within {\n    .options {\n        @apply block;\n    }\n}\n\n.non-loaded-item {\n    @apply px-5 py-5 pb-10 pr-0 align-middle;\n}\n.disabled {\n    @apply text-gray-400 cursor-default;\n}\n\n// Overriding Tailwind's line-clamp classes,\n// which occasionally fail or disappear for no reason\n\n// NOTE: The multiline legend items use the CSS line-clamp\n// property. If padding is used, it will start showing the\n// clamped/hidden text using the padding space, which can lead\n// to fragments of the clamped text showing up. In these cases,\n// refactor to use margin.\n\n.line-clamp-1 {\n    overflow: hidden;\n    display: -webkit-box;\n    -webkit-box-orient: vertical;\n    -webkit-line-clamp: 1;\n}\n\n.line-clamp-2 {\n    overflow: hidden;\n    display: -webkit-box;\n    -webkit-box-orient: vertical;\n    -webkit-line-clamp: 2;\n}\n\n.line-clamp-3 {\n    overflow: hidden;\n    display: -webkit-box;\n    -webkit-box-orient: vertical;\n    -webkit-line-clamp: 3;\n}\n\n.line-clamp-4 {\n    overflow: hidden;\n    display: -webkit-box;\n    -webkit-box-orient: vertical;\n    -webkit-line-clamp: 4;\n}\n\n.line-clamp-5 {\n    overflow: hidden;\n    display: -webkit-box;\n    -webkit-box-orient: vertical;\n    -webkit-line-clamp: 5;\n}\n\n.line-clamp-6 {\n    overflow: hidden;\n    display: -webkit-box;\n    -webkit-box-orient: vertical;\n    -webkit-line-clamp: 6;\n}\n</style>\n"],"names":["t","useI18n","props","__props","initialChecked","ref","onMounted","_noSymbolsVisible","item","toggleVisibility","LegendItem","LayerItem","filterGuts","sql","CoreFilter","iApi","inject","dropdown","hovered","panelStore","usePanelStore","mobileMode","emit","__emit","legendOptionKey","toggleSymbology","LayerControl","toggleGrid","getFixtureExists","GlobalEvents","toggleSettings","toggleMetadata","metaConfig","name","catalogueUrl","parseUrl","metadataExtension","metadataType","zoomToLayerBoundary","removeLayer","reloadLayer","e","reloadableLayer","toRaw","computed","hover","fixtureName","stack","l","featCountText","layerData","LayerType","layerStore","useLayerStore","el","legendStore","useLegendStore","allowMultilineItems","maxLines","layerConfigs","symbologyStack","symbologyStackLoaded","legendFocusItem","useTemplateRef","layerType","modifiableLayer","rawLayer","isAnimationEnabled","isGroup","controlAvailable","control","LegendControl","markdownToHtml","md","marked","toggleExpand","expanded","getDatagridExists","getLegendGraphic","span","svg","layerItemProp","recreateFromConfig","testParent","targetId","layerConfig","lc","recreateLayer","checkLayer","reloadErr","to","layer","cancelOrRemoveLayer","layerItem","safetyCount","LegendType","removalWatcher","rampL","InitiationState","cancelWatcher","parentmostId","parentLayer","block","loadSymbologyStack","watch"],"mappings":"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"}